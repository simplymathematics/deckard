schema: '2.0'
stages:
  prepare:
    cmd: python -m deckard.layers.prepare
    params:
      params.yaml:
<<<<<<< HEAD
        prepare.config:
=======
        prepare:
>>>>>>> f94663d (fixed build)
          name: iris
          params:
            shuffle: true
            stratify: true
            random_state: 0
<<<<<<< HEAD
            test_size:
            train_size: 0.8
          data_file: data.pkl
          output_folder: .
    outs:
    - path: data.pkl
      md5: 4cb45af79f0ad08ff7dca71fdd07417a
      size: 4727
  train:
    cmd: python -m deckard.layers.sklearn_model --layer_name train
    deps:
    - path: prepare/data.pickle
      md5: 00709c0ce9102f9b40600ac0e451c800
      size: 4753
    params:
      params.yaml:
        control:
          model_type: sklearn
          data_file: data.pkl
          output_folder: control
          input_folder: .
          output_name: control_model.pickle
          config:
            name: sklearn.linear_model.LogisticRegression
            params:
              penalty: l2
    outs:
    - path: train/ground_truth.json
      md5: ebd226610027480795b3ad51a79f3e20
      size: 799
    - path: train/model_params.json
      md5: d590cf74eabc4aff20b4a0048725848f
      size: 155
    - path: train/predictions.json
      md5: cf78b1d66265e57751091d704e15766b
      size: 207
    - path: train/train_model.pickle
      md5: 32f9a7805777bbd6ac45547790864061
      size: 828
=======
            train_size: 0.8
          data_file: data.pkl
          output_folder: .
    outs:
    - path: data.pkl
      md5: edcc0ec9351255917d064384a242c567
      size: 4727
  train:
    cmd: python -m deckard.layers.sklearn_model --layer_name train
    deps:
    - path: data.pkl
      md5: edcc0ec9351255917d064384a242c567
      size: 4727
    params:
      params.yaml:
        train:
          input_folder: .
          input_name: model.pickle
          output_folder: train
          output_name: model.pickle
          data_file: data.pkl
          layer_name: train
          config:
            name: sklearn.linear_model.LogisticRegression
            params:
              penalty: l2
          classifier: false
          model_type: sklearn
          is_fitted: false
    outs:
    - path: train/
      md5: 9fa2d9e68e43cc5b4e7dc204680a2d86.dir
      size: 1834
      nfiles: 3
  preprocess:
    cmd: python  -m deckard.layers.preprocess --layer_name preprocess --position 0
    deps:
    - path: train/
      md5: 9fa2d9e68e43cc5b4e7dc204680a2d86.dir
      size: 1834
      nfiles: 3
    params:
      params.yaml:
        preprocess:
          input_folder: train
          output_folder: preprocess
          input_name: model.pickle
          output_name: model
          data_file: data.pkl
          layer_name: preprocess
          position: 0
          config:
            name: sklearn.preprocessing.StandardScaler
            params:
              with_mean: true
              with_std: true
          classifier: false
          model_type: sklearn
          is_fitted: false
    outs:
    - path: preprocess/
      md5: c4a25dae8b2c5e2fea5aab74f835ed2d.dir
      size: 2307
      nfiles: 3
  featurize:
    cmd: python  -m deckard.layers.preprocess --layer_name featurize --position 1
    deps:
    - path: preprocess/
      md5: c4a25dae8b2c5e2fea5aab74f835ed2d.dir
      size: 2307
      nfiles: 3
    params:
      params.yaml:
        featurize:
          input_folder: preprocess
          output_folder: featurize
          input_name: model
          output_name: model.pickle
          data_file: data.pkl
          layer_name: featurize
          position: 1
          config:
            name: sklearn.impute.SimpleImputer
            params:
              strategy: mean
          classifier: false
          model_type: sklearn
          is_fitted: false
    outs:
    - path: featurize/
      md5: d9435a15dbd259a6708f38571eefe2da.dir
      size: 2578
      nfiles: 3
  control:
    cmd: python  -m deckard.layers.art_model --layer_name control
    deps:
    - path: data.pkl
      md5: edcc0ec9351255917d064384a242c567
      size: 4727
    params:
      params.yaml:
        control:
          model_type: sklearn
          data_file: data.pkl
          output_folder: control
          input_folder: .
          output_name: control_model.pickle
          config:
            name: sklearn.linear_model.LogisticRegression
            params:
              penalty: l2
    outs:
    - path: control/
      md5: 7325a63c8dd1574606ed5f0c97d45f56.dir
      size: 3224
      nfiles: 3
  defend:
    cmd: python  -m deckard.layers.defend --layer_name defend
    deps:
    - path: control/
      md5: 7325a63c8dd1574606ed5f0c97d45f56.dir
      size: 3224
      nfiles: 3
    - path: data.pkl
      md5: edcc0ec9351255917d064384a242c567
      size: 4727
    params:
      params.yaml:
        defend:
          input_model: control_model.pickle
          input_folder: control
          model_type: sklearn
          data_file: data.pkl
          output_folder: defences
          output_name: defended_model
          config:
            name: art.defences.preprocessor.FeatureSqueezing
            params:
              bit_depth: 8
              clip_values:
              - 0
              - 255
    outs:
    - path: defences/
      md5: 4fbc2487598ac6ffc5fd0fd89b00fca2.dir
      size: 3236
      nfiles: 3
  attack:
    cmd: python  -m deckard.layers.attack --layer_name attack
    deps:
    - path: data.pkl
      md5: edcc0ec9351255917d064384a242c567
      size: 4727
    - path: defences/
      md5: 4fbc2487598ac6ffc5fd0fd89b00fca2.dir
      size: 3236
      nfiles: 3
    params:
      params.yaml:
        attack:
          config:
            name: art.attacks.evasion.HopSkipJump
            params:
              max_iter: 100
          input_model: defended_model.pickle
          input_folder: defences
          model_type: sklearn
          data_file: data.pkl
          output_folder: attacks
          output_name: attacked_model
          attack_size: 100
    outs:
    - path: attacks/
      md5: 3ae9b9e82fad79837dab659858a7eb25.dir
      size: 4187
      nfiles: 4
  evaluate:
    cmd: python  -m deckard.layers.evaluate --layer_name evaluate
    deps:
    - path: attacks/
      md5: 3ae9b9e82fad79837dab659858a7eb25.dir
      size: 4187
      nfiles: 4
    - path: control/
      md5: 7325a63c8dd1574606ed5f0c97d45f56.dir
      size: 3224
      nfiles: 3
    - path: defences/
      md5: 4fbc2487598ac6ffc5fd0fd89b00fca2.dir
      size: 3236
      nfiles: 3
    - path: featurize/
      md5: d9435a15dbd259a6708f38571eefe2da.dir
      size: 2578
      nfiles: 3
    - path: preprocess/
      md5: c4a25dae8b2c5e2fea5aab74f835ed2d.dir
      size: 2307
      nfiles: 3
    - path: train/
      md5: 9fa2d9e68e43cc5b4e7dc204680a2d86.dir
      size: 1834
      nfiles: 3
    params:
      params.yaml:
        evaluate:
          input_folder: .
          ground_truth_file: ground_truth.json
          predictions_file: predictions.json
          layer_name: evaluate
          config:
            name:
            params:
          output_folder: scores/
          output_name: scores.json
          is_regressor: true
    outs:
    - path: scores/
      md5: a981fd42ec3300f2675916f746019587.dir
      size: 1512
      nfiles: 1
  visualise:
    cmd: python  -m deckard.layers.visualise --layer_name visualise
    deps:
    - path: train/
      md5: 9fa2d9e68e43cc5b4e7dc204680a2d86.dir
      size: 1834
      nfiles: 3
    params:
      params.yaml:
        visualise:
          input_folder: train/
          data_file: data.pkl
          data_folder: .
          model_folder: train/
          model_file: model.pickle
          defense_file: None
          preprocessor_file: None
          config:
            name:
            params:
          output_folder: plots
          root_folder: .
          model_type: sklearn
          art: false
          plot_folder: plots
    outs:
    - path: plots/
      md5: 3b9c0da439d31c4a63784c306206b666.dir
      size: 14277
      nfiles: 1
>>>>>>> f94663d (fixed build)
