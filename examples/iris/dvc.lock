schema: '2.0'
stages:
  prepare:
    cmd: python -m deckard.layers.prepare
    params:
      params.yaml:
        prepare.config:
          name: iris
          params:
            shuffle: true
            stratify: true
            random_state: 0
            test_size:
            train_size: 0.8
    outs:
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
  train:
    cmd: python -m deckard.layers.sklearn_model --layer_name train
    deps:
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
    params:
      params.yaml:
        train.config:
          name: sklearn.linear_model.LogisticRegression
          params:
            penalty: l2
    outs:
    - path: train/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: train/model.pickle
      md5: 0740a0e87607008e45401148dd018513
      size: 828
    - path: train/predictions.json
      md5: 6a6bd41a6880d229631604c7bc9bf1e0
      size: 90
  preprocess:
    cmd: python -m deckard.layers.preprocess --layer_name preprocess --position 0
    deps:
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
    - path: train/model.pickle
      md5: 0740a0e87607008e45401148dd018513
      size: 828
    params:
      params.yaml:
        preprocess.config:
          name: sklearn.preprocessing.StandardScaler
          params:
            with_mean: true
            with_std: true
    outs:
    - path: preprocess/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: preprocess/model.pickle
      md5: 49a62d949a168d862e30d6d076a54ac7
      size: 1301
    - path: preprocess/predictions.json
      md5: 971350f4a6c58f233010299775a02fc7
      size: 90
  featurize:
    cmd: python -m deckard.layers.preprocess --layer_name featurize --position 1
    deps:
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
    - path: preprocess/model.pickle
      md5: 49a62d949a168d862e30d6d076a54ac7
      size: 1301
    params:
      params.yaml:
        featurize.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: featurize/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: featurize/model.pickle
      md5: 40c8b5375597ffbe172d7390aecd6d23
      size: 1572
    - path: featurize/predictions.json
      md5: 971350f4a6c58f233010299775a02fc7
      size: 90
  art_model:
    cmd: python -m deckard.layers.art_model --layer_name art_model
    deps:
    - path: featurize/model.pickle
      md5: 40c8b5375597ffbe172d7390aecd6d23
      size: 1572
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
    params:
      params.yaml:
        train.config:
          name: sklearn.linear_model.LogisticRegression
          params:
            penalty: l2
    outs:
    - path: art_model/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: art_model/model.pickle
      md5: 40c8b5375597ffbe172d7390aecd6d23
      size: 1572
    - path: art_model/predictions.json
      md5: 971350f4a6c58f233010299775a02fc7
      size: 90
  defend:
    cmd: python -m deckard.layers.defend --layer_name defend
    deps:
    - path: art_model/model.pickle
      md5: 40c8b5375597ffbe172d7390aecd6d23
      size: 1572
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
    params:
      params.yaml:
        defend.config:
          name: art.defences.preprocessor.FeatureSqueezing
          params:
            bit_depth: 8
    outs:
    - path: defend/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: defend/model.pickle
      md5: fc172efd4b81c64810b5809fe45a6b96
      size: 1606
    - path: defend/predictions.json
      md5: a953474c7e78f6edd8bdcaefed62f18a
      size: 1954
  attack:
    cmd: python -m deckard.layers.attack --layer_name attack
    deps:
    - path: defend/model.pickle
      md5: fc172efd4b81c64810b5809fe45a6b96
      size: 1606
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
    params:
      params.yaml:
        attack.config:
          name: art.attacks.evasion.HopSkipJump
          params:
            max_iter: 100
    outs:
    - path: attack/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: attack/predictions.json
      md5: a953474c7e78f6edd8bdcaefed62f18a
      size: 1954
  visualise:
    cmd: python -m deckard.layers.visualise --layer_name visualise
    deps:
    - path: defend/model.pickle
      md5: fc172efd4b81c64810b5809fe45a6b96
      size: 1606
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
    params:
      params.yaml:
        visualise.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: ./ROC_AUC.pdf
      md5: 980ed6576dc2ae215c8877cea3339709
      size: 15177
  evaluate:
    cmd: python -m deckard.layers.evaluate --layer_name evaluate
    deps:
    - path: art_model
      md5: 79c7d645bed52642a8a747ad87a8f6ca.dir
      size: 2694
      nfiles: 7
    - path: attack
      md5: abaa594e37f4f53c70e32f72a31ed08f.dir
      size: 15567
      nfiles: 10
    - path: defend
      md5: ee3d5b901fb96e76d6575dc9abf91fcb.dir
      size: 12320
      nfiles: 7
    - path: featurize
      md5: b806c4a5194fa891d983b7e329ae0499.dir
      size: 8965
      nfiles: 7
    - path: prepare
      md5: 180cea72dd1459245cec66b9d4380a38.dir
      size: 4767
      nfiles: 1
    - path: preprocess
      md5: add56c6a36dde9c5db4316a7ed65614e.dir
      size: 5294
      nfiles: 7
    - path: train
      md5: fe00c3cc922e2e4d71c0a8fccdf8fc9b.dir
      size: 2981
      nfiles: 10
    params:
      params.yaml:
        evaluate.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: evaluate/scores.json
      md5: 7d9a9a07fe28b68388c37e35540da27f
      size: 324
