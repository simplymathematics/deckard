schema: '2.0'
stages:
  prepare:
    cmd: python -m deckard.layers.prepare
    params:
      params.yaml:
        prepare.config:
          name: iris
          params:
            shuffle: true
            stratify: true
            random_state: 0
            test_size:
            train_size: 0.8
    outs:
    - path: prepare/data.pickle
      md5: 0b7a05984fc7511c2d85952e64d94511
      size: 4767
  train:
    cmd: python -m deckard.layers.sklearn_model --layer_name train
    deps:
    - path: prepare/data.pickle
      md5: 0b7a05984fc7511c2d85952e64d94511
      size: 4767
    params:
      params.yaml:
        train.config:
          name: sklearn.linear_model.LogisticRegression
          params:
            penalty: l2
    outs:
    - path: train/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: train/model.pickle
      md5: fe72124e8e50035f4c447db9e5a9c332
      size: 828
    - path: train/predictions.json
      md5: 82d247b3e67d10a25b629a7a2b8c3819
      size: 241
  preprocess:
    cmd: python -m deckard.layers.preprocess --layer_name preprocess --position 0
    deps:
    - path: prepare/data.pickle
      md5: 0b7a05984fc7511c2d85952e64d94511
      size: 4767
    - path: train/model.pickle
      md5: fe72124e8e50035f4c447db9e5a9c332
      size: 828
    params:
      params.yaml:
        preprocess.config:
          name: sklearn.preprocessing.StandardScaler
          params:
            with_mean: true
            with_std: true
    outs:
    - path: preprocess/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: preprocess/model.pickle
      md5: 1ea7fade30c1ea68ff8e6e3e782bc705
      size: 1301
    - path: preprocess/predictions.json
      md5: 76c2287827378f4a35d2d078c3d99c3d
      size: 241
  featurize:
    cmd: python -m deckard.layers.preprocess --layer_name featurize --position 1
    deps:
    - path: prepare/data.pickle
      md5: c7038d89baff44c0d2b3714fd66d060a
      size: 4767
    - path: preprocess/model.pickle
      md5: 1ea7fade30c1ea68ff8e6e3e782bc705
      size: 1301
    params:
      params.yaml:
        featurize.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: featurize/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: featurize/model.pickle
      md5: ea97d6e01867334270f1d6757b33dfb0
      size: 1572
    - path: featurize/predictions.json
      md5: 76c2287827378f4a35d2d078c3d99c3d
      size: 241
  art_model:
    cmd: python -m deckard.layers.art_model --layer_name art_model
    deps:
    - path: featurize/model.pickle
      md5: ea97d6e01867334270f1d6757b33dfb0
      size: 1572
    - path: prepare/data.pickle
      md5: c7038d89baff44c0d2b3714fd66d060a
      size: 4767
    params:
      params.yaml:
        train.config:
          name: sklearn.linear_model.LogisticRegression
          params:
            penalty: l2
    outs:
    - path: art_model/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: art_model/model.pickle
      md5: d7a3f8e94d3d06ce8b4abd6782b987d3
      size: 1572
    - path: art_model/predictions.json
      md5: 76c2287827378f4a35d2d078c3d99c3d
      size: 241
  defend:
    cmd: python -m deckard.layers.defend --layer_name defend
    deps:
    - path: art_model/model.pickle
      md5: d7a3f8e94d3d06ce8b4abd6782b987d3
      size: 1572
    - path: prepare/data.pickle
      md5: c7038d89baff44c0d2b3714fd66d060a
      size: 4767
    params:
      params.yaml:
        defend.config:
          name: art.defences.preprocessor.FeatureSqueezing
          params:
            bit_depth: 8
    outs:
    - path: defend/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: defend/model.pickle
      md5: 0941602fa90ff629c674c8788aaaeaaa
      size: 1606
    - path: defend/predictions.json
      md5: 82d1638e6b60e846aa33347acd8c60a5
      size: 1583
  attack:
    cmd: python -m deckard.layers.attack --layer_name attack
    deps:
    - path: defend/model.pickle
      md5: 0941602fa90ff629c674c8788aaaeaaa
      size: 1606
    - path: prepare/data.pickle
      md5: c7038d89baff44c0d2b3714fd66d060a
      size: 4767
    params:
      params.yaml:
        attack.config:
          name: art.attacks.evasion.HopSkipJump
          params:
            max_iter: 100
    outs:
    - path: attack/ground_truth.json
      md5: 15b139705b6a95a92402b4ffaacab2d6
      size: 510
    - path: attack/predictions.json
      md5: 82d1638e6b60e846aa33347acd8c60a5
      size: 1583
  visualise:
    cmd: python -m deckard.layers.visualise --layer_name visualise
    deps:
    - path: defend/model.pickle
      md5: fc172efd4b81c64810b5809fe45a6b96
      size: 1606
    - path: prepare/data.pickle
      md5: dffe3243da0970f1e4bc13f296de3e33
      size: 4767
    params:
      params.yaml:
        visualise.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: ./ROC_AUC.pdf
      md5: 980ed6576dc2ae215c8877cea3339709
      size: 15177
  evaluate:
    cmd: python -m deckard.layers.evaluate --layer_name evaluate
    deps:
    - path: art_model
      md5: 2112064840d74b9b9c415bef584e0eb5.dir
      size: 3362
      nfiles: 10
    - path: attack
      md5: 687f41d3a54d7a676a3b499009cb27d9.dir
      size: 22543
      nfiles: 10
    - path: defend
      md5: 99e3358739e9f3d4c03f44f175e777fb.dir
      size: 28049
      nfiles: 10
    - path: featurize
      md5: 61995bcf9df5631a9403f1b165392123.dir
      size: 22574
      nfiles: 10
    - path: prepare
      md5: a936729ff648b6eb66a06d03f30a3f5c.dir
      size: 4767
      nfiles: 1
    - path: preprocess
      md5: ea3b57c687bc0de4d43c401174d9b286.dir
      size: 12174
      nfiles: 10
    - path: train
      md5: 5c03fc1ad0887ffa455607a84ea5d156.dir
      size: 4391
      nfiles: 13
    params:
      params.yaml:
        evaluate.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: evaluate/scores.json
      md5: a6914a9bb9b3db93c7a486fa482f812f
      size: 324
