schema: '2.0'
stages:
  prepare:
    cmd: python -m deckard.layers.prepare
    params:
      params.yaml:
        prepare.config:
          name: iris
          params:
            shuffle: true
            stratify: true
            random_state: 0
            test_size:
            train_size: 0.8
    outs:
    - path: prepare/data.pickle
      md5: 2c693b5f2609fdcb3f26a8b023d1af57
      size: 4767
  train:
    cmd: python -m deckard.layers.sklearn_model --layer_name train
    deps:
    - path: prepare/data.pickle
      md5: 2c693b5f2609fdcb3f26a8b023d1af57
      size: 4767
    params:
      params.yaml:
        train.config:
          name: sklearn.linear_model.LogisticRegression
          params:
            penalty: l2
    outs:
    - path: train/ground_truth.json
      md5: 4e3ac1e5974ad292654fbf0aaae3d779
      size: 781
    - path: train/model.pickle
      md5: 32f485222c5ce6bccdc8753fee7d7af8
      size: 828
    - path: train/predictions.json
      md5: dffc83778e5d8f097efd815ee03467fc
      size: 241
  preprocess:
    cmd: python -m deckard.layers.preprocess --layer_name preprocess --position 0
    deps:
    - path: prepare/data.pickle
      md5: 2c693b5f2609fdcb3f26a8b023d1af57
      size: 4767
    - path: train/model.pickle
      md5: 32f485222c5ce6bccdc8753fee7d7af8
      size: 828
    params:
      params.yaml:
        preprocess.config:
          name: sklearn.preprocessing.StandardScaler
          params:
            with_mean: true
            with_std: true
    outs:
    - path: preprocess/ground_truth.json
      md5: 4e3ac1e5974ad292654fbf0aaae3d779
      size: 781
    - path: preprocess/model.pickle
      md5: e511e534f0007352b9693d39c0e04fa3
      size: 1301
    - path: preprocess/predictions.json
      md5: 8ab7f00a0dfe7049d13ff3e24594ebec
      size: 241
  featurize:
    cmd: python -m deckard.layers.preprocess --layer_name featurize --position 1
    deps:
    - path: prepare/data.pickle
      md5: 2c693b5f2609fdcb3f26a8b023d1af57
      size: 4767
    - path: preprocess/model.pickle
      md5: e511e534f0007352b9693d39c0e04fa3
      size: 1301
    params:
      params.yaml:
        featurize.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: featurize/ground_truth.json
      md5: 4e3ac1e5974ad292654fbf0aaae3d779
      size: 781
    - path: featurize/model.pickle
      md5: bb1d3edbfc6faa9179354f2aeb4b547d
      size: 1572
    - path: featurize/predictions.json
      md5: 8ab7f00a0dfe7049d13ff3e24594ebec
      size: 241
  art_model:
    cmd: python -m deckard.layers.art_model --layer_name art_model
    deps:
    - path: featurize/model.pickle
      md5: bb1d3edbfc6faa9179354f2aeb4b547d
      size: 1572
    - path: prepare/data.pickle
      md5: 2c693b5f2609fdcb3f26a8b023d1af57
      size: 4767
    params:
      params.yaml:
        train.config:
          name: sklearn.linear_model.LogisticRegression
          params:
            penalty: l2
    outs:
    - path: art_model/ground_truth.json
      md5: 4e3ac1e5974ad292654fbf0aaae3d779
      size: 781
    - path: art_model/model.pickle
      md5: bb1d3edbfc6faa9179354f2aeb4b547d
      size: 1572
    - path: art_model/predictions.json
      md5: 8ab7f00a0dfe7049d13ff3e24594ebec
      size: 241
  defend:
    cmd: python -m deckard.layers.defend --layer_name defend
    deps:
    - path: art_model/model.pickle
      md5: bb1d3edbfc6faa9179354f2aeb4b547d
      size: 1572
    - path: prepare/data.pickle
      md5: 2c693b5f2609fdcb3f26a8b023d1af57
      size: 4767
    params:
      params.yaml:
        defend.config:
          name: art.defences.preprocessor.FeatureSqueezing
          params:
            bit_depth: 8
    outs:
    - path: defend/ground_truth.json
      md5: 4e3ac1e5974ad292654fbf0aaae3d779
      size: 781
    - path: defend/model.pickle
      md5: d16d1e5cbf13d994b8c627c9aaa58aca
      size: 1606
    - path: defend/predictions.json
      md5: d9a35b245e661d29eaf10d84ded53d50
      size: 1584
  attack:
    cmd: python -m deckard.layers.attack --layer_name attack
    deps:
    - path: defend/model.pickle
      md5: d16d1e5cbf13d994b8c627c9aaa58aca
      size: 1606
    - path: prepare/data.pickle
      md5: 2c693b5f2609fdcb3f26a8b023d1af57
      size: 4767
    params:
      params.yaml:
        attack.config:
          name: art.attacks.evasion.HopSkipJump
          params:
            max_iter: 100
    outs:
    - path: attack/ground_truth.json
      md5: 4e3ac1e5974ad292654fbf0aaae3d779
      size: 781
    - path: attack/predictions.json
      md5: d9a35b245e661d29eaf10d84ded53d50
      size: 1584
  visualise:
    cmd: python -m deckard.layers.visualise --layer_name visualise
    deps:
    - path: defend/model.pickle
      md5: d16d1e5cbf13d994b8c627c9aaa58aca
      size: 1606
    - path: prepare/data.pickle
      md5: 2c693b5f2609fdcb3f26a8b023d1af57
      size: 4767
    params:
      params.yaml:
        visualise.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: ./ROC_AUC.pdf
      md5: 474b48ce3dbae788b712d94521df1b61
      size: 15724
  evaluate:
    cmd: python -m deckard.layers.evaluate --layer_name evaluate
    deps:
    - path: art_model
      md5: ef3403ba3f9cfc697eefb9f371f99911.dir
      size: 3461
      nfiles: 9
    - path: attack
      md5: 065add42f358c81bf4e7f1e7536026ba.dir
      size: 25114
      nfiles: 13
    - path: defend
      md5: dad87c2993bdb739ae3bcc9a9846be4d.dir
      size: 22416
      nfiles: 10
    - path: featurize
      md5: b35a44b33d3494e17ef9aa05cc64538a.dir
      size: 17237
      nfiles: 9
    - path: prepare
      md5: b1ca8cedffb5234c0af0733e66e0295d.dir
      size: 4767
      nfiles: 1
    - path: preprocess
      md5: 232a60b52dd21edb463ec4d8bc7c687f.dir
      size: 12770
      nfiles: 9
    - path: train
      md5: 961314b5191bf60ca15bdc0cf1c9ce18.dir
      size: 8496
      nfiles: 12
    params:
      params.yaml:
        evaluate.config:
          name: sklearn.impute.SimpleImputer
          params:
            strategy: mean
    outs:
    - path: evaluate/scores.json
      md5: 60d70d7eb5dcb54ebc0cf96689ff48d9
      size: 324
