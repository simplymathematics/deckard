stages:
  prepare:
    cmd: python ../../deckard/layers/prepare  ${params.prepare.config}
    params:
      - prepare.config
    outs: 
      - params.prepare.outputs.file
      - params.prepare.outputs.folder
    # deps:
    #   - 
    # metrics:
    #   - prepare.scores
    # plots:
    #   - prepare.plots
  train:
<<<<<<< HEAD
    cmd: python -m deckard.layers.train  ${params.prepare.config}
=======
<<<<<<< HEAD
    cmd: python -m deckard.layers.sklearn_model --layer_name train
>>>>>>> bb2938c (fixed build)
    params:
      - params.train.config
    outs: 
      - ${train.outputs.folder}/:
          cache: true
=======
    cmd:  python -m deckard.layers.sklearn_model --layer_name train
    deps:
    - data.pkl
    params:
    - train
    outs:
    - train/:
        cache: true
  preprocess:
    cmd: python  -m deckard.layers.preprocess --layer_name preprocess --position 0
>>>>>>> f94663d (fixed build)
    deps:
      - params.prepare.output.file
      - params.prepare.output.folder
    # metrics:
    #   - train.scores
    # plots:
    #   - train.plots
  preprocess:
    cmd: python -m deckard.layers.preprocess --layer_name preprocess
    params:
      - preprocess
    outs:
    - ${preprocess.outputs.folder}:
        cache: true
  featurize:
    cmd: python  -m deckard.layers.preprocess --layer_name featurize --position 1
    deps:
    - preprocess/
    params:
      - featurize
    outs:
    - ${featurize.outputs.folder}:
        cache: true
  visualise:
    cmd: python  -m deckard.layers.visualise --layer_name visualise
    deps: 
      - train/
    params:
      - visualise
    outs:
      - plots/:
          cache: true
  control:
    cmd:  python  -m deckard.layers.art_model --layer_name control
    deps:
    - data.pkl
    params:
    - control
    outs:
    - control/:
        cache: true
  defend:
    cmd:  python  -m deckard.layers.defend --layer_name defend
    deps:
    - data.pkl
    - control/
    params:
    - defend
    outs:
    - defences/:
        cache: true
  attack:
    cmd:  python  -m deckard.layers.attack --layer_name attack
    deps:
    - data.pkl
    - defences/
    params:
    - attack
    outs:
    - attacks/:
        cache: true
  evaluate:
    cmd: python  -m deckard.layers.evaluate --layer_name evaluate
    deps: 
      - featurize/
      - control/
      - preprocess/
      - train/
      - attacks/
      - defences/
    params:
      - evaluate
    outs:
      - scores/
