schema: '2.0'
stages:
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder plots/cifar100/
      --output_file merged.csv
    deps:
    - path: ../conf/clean.yaml
      md5: eba3dd17dd820ad8273a37ba57ea73b7
      size: 392
    - path: data/bit_depth/cifar100/power.csv
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3988195
    - path: data/cifar100/power.csv
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16085014
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/cifar100/merged.csv
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20103676
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i plots/cifar100/merged.csv --o plots/cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      md5: eba3dd17dd820ad8273a37ba57ea73b7
      size: 392
    - path: plots/cifar100/merged.csv
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20103676
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          nb_epoch: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/cifar100/clean.csv
      md5: 5463110b031067195ee6204dca9c9ea2
      size: 3564572
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file plots/cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/cifar100/  --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      md5: ba48c8059bc4d6b9822853c6b923c764
      size: 4853
    - path: plots/cifar100/clean.csv
      md5: 5463110b031067195ee6204dca9c9ea2
      size: 3564572
    outs:
    - path: plots/cifar100/aft_comparison.csv
      md5: f58bfa84130f0dd08a9fd17e87d2a599
      size: 459
    - path: plots/cifar100/aft_comparison.tex
      md5: 7ab94e2b17f72808c872b8ac44e58e26
      size: 631
    - path: plots/cifar100/cox_aft.pdf
      md5: 8f3715f5cc0f4c4cf0b289fda6cb5977
      size: 20597
    - path: plots/cifar100/cox_epochs_partial_effect.pdf
      md5: a2fe9aac2282302a9e4d09890b88bb42
      size: 30345
    - path: plots/cifar100/log_logistic_aft.pdf
      md5: 892418e0edaa4928298fb1b19ae54667
      size: 22335
    - path: plots/cifar100/log_logistic_epochs_partial_effect.pdf
      md5: 0e2f049818b0d6c43e46c33180578efe
      size: 27690
    - path: plots/cifar100/log_normal_aft.pdf
      md5: d7821b59ecefb3daaf2e06a866893b5e
      size: 23084
    - path: plots/cifar100/log_normal_epochs_partial_effect.pdf
      md5: 094c074838ad6cbd77039b0bd4d60b79
      size: 28517
    - path: plots/cifar100/weibull_aft.pdf
      md5: df66c98a365ad0c0d30e72137be6c401
      size: 30079
    - path: plots/cifar100/weibull_epochs_partial_effect.pdf
      md5: a71fd39a86ebbdbfd12260dda4158078
      size: 27354
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder plots/cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      md5: eba3dd17dd820ad8273a37ba57ea73b7
      size: 392
    - path: data/bit_depth/cifar/power.csv
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5292031
    - path: data/cifar/power.csv
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9999301
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/cifar/merged.csv
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15307632
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder plots/mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      md5: eba3dd17dd820ad8273a37ba57ea73b7
      size: 392
    - path: data/bit_depth/mnist/power.csv
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5422584
    - path: data/mnist/power.csv
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9970090
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/mnist/merged.csv
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15411588
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i plots/mnist/merged.csv --o plots/mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      md5: eba3dd17dd820ad8273a37ba57ea73b7
      size: 392
    - path: plots/mnist/merged.csv
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15411588
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          nb_epoch: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/mnist/clean.csv
      md5: 1cb59603927ff95aaceccdd3425feadb
      size: 9236530
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file plots/mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/mnist/  --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      md5: ba48c8059bc4d6b9822853c6b923c764
      size: 4853
    - path: plots/mnist/clean.csv
      md5: 1cb59603927ff95aaceccdd3425feadb
      size: 9236530
    outs:
    - path: plots/mnist/aft_comparison.csv
      md5: de519adac05bb1c1d97599656e9c7b22
      size: 466
    - path: plots/mnist/aft_comparison.tex
      md5: e9d0235d6761e11914d4fa7451f8ba7b
      size: 675
    - path: plots/mnist/cox_aft.pdf
      md5: 30185de5c58b862e4ab6b55a47c6b4fc
      size: 20317
    - path: plots/mnist/cox_epochs_partial_effect.pdf
      md5: c79eba67242957939f492d40f7600e48
      size: 31744
    - path: plots/mnist/log_logistic_aft.pdf
      md5: 98b4dd57d5424fd2c81c5818e1e61a63
      size: 22750
    - path: plots/mnist/log_logistic_epochs_partial_effect.pdf
      md5: abebc16e992c346fb293394e11b761e1
      size: 27423
    - path: plots/mnist/log_normal_aft.pdf
      md5: 21de97b66d81f801c829638bec8ec412
      size: 23155
    - path: plots/mnist/log_normal_epochs_partial_effect.pdf
      md5: 94785b7a70f996247eea8b6e4bca0b01
      size: 28313
    - path: plots/mnist/weibull_aft.pdf
      md5: 637256def31e73f5f3478b73afe520d1
      size: 29797
    - path: plots/mnist/weibull_epochs_partial_effect.pdf
      md5: 9eba70d97ea7cf65b7a90c8bc1fa5af6
      size: 27068
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i plots/cifar/merged.csv --o plots/cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      md5: eba3dd17dd820ad8273a37ba57ea73b7
      size: 392
    - path: plots/cifar/merged.csv
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15307632
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          nb_epoch: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/cifar/clean.csv
      md5: 747305ca7d3e92c73c92985a35c5e664
      size: 9247427
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file plots/cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/cifar/  --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      md5: ba48c8059bc4d6b9822853c6b923c764
      size: 4853
    - path: plots/cifar/clean.csv
      md5: 747305ca7d3e92c73c92985a35c5e664
      size: 9247427
    outs:
    - path: plots/cifar/aft_comparison.csv
      md5: 4bc7aa6c0459bcf73d4dea6474085b39
      size: 462
    - path: plots/cifar/aft_comparison.tex
      md5: b11c4e3119a67789a2e2a02dce05d1ed
      size: 675
    - path: plots/cifar/cox_aft.pdf
      md5: b89d28fd1cfea4314b0e489d97050eca
      size: 20691
    - path: plots/cifar/cox_epochs_partial_effect.pdf
      md5: c043c26117c79fc7cd9d77edf1440d3f
      size: 32672
    - path: plots/cifar/log_logistic_aft.pdf
      md5: 2227c956ad58330303170fde6f30f101
      size: 22399
    - path: plots/cifar/log_logistic_epochs_partial_effect.pdf
      md5: db98cffb0cb48cfcba8a9965ca2278e0
      size: 27909
    - path: plots/cifar/log_normal_aft.pdf
      md5: f81d4f67c40bf3598df6d3b04673ed91
      size: 23492
    - path: plots/cifar/log_normal_epochs_partial_effect.pdf
      md5: 2914627bb6dbfd17cedd9e0f04a12a3c
      size: 28673
    - path: plots/cifar/weibull_aft.pdf
      md5: e84efaeef885c07cc98fe050867703df
      size: 29449
    - path: plots/cifar/weibull_epochs_partial_effect.pdf
      md5: 4ef5b0e86fa5e23245ea15dfba86fb5f
      size: 27534
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: combined_plots.py
      md5: ed2163a704afb7c966484091e80272b1
      size: 7424
    - path: plots/cifar/aft_comparison.csv
      md5: 4bc7aa6c0459bcf73d4dea6474085b39
      size: 462
    - path: plots/cifar100/aft_comparison.csv
      md5: f58bfa84130f0dd08a9fd17e87d2a599
      size: 459
    - path: plots/mnist/aft_comparison.csv
      md5: de519adac05bb1c1d97599656e9c7b22
      size: 466
    outs:
    - path: data/combined/combined.csv
      md5: f52c78b3fe9ecf7d7724dbb2f24c5d42
      size: 52364567
    - path: plots/combined/acc.pdf
      md5: 5ef8df77882e2309b92bc285023cff17
      size: 32472
    - path: plots/combined/cost.pdf
      md5: a86db06b4fdd876580e8bd188cec98e8
      size: 41642
    - path: plots/combined/power.pdf
      md5: 6522b5834abc1ee0071ff31af6901baf
      size: 41620
    - path: plots/combined/time.pdf
      md5: b631722592305c4c9537a0432c119a03
      size: 41542
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o plots/combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      md5: eba3dd17dd820ad8273a37ba57ea73b7
      size: 392
    - path: data/combined/combined.csv
      md5: f52c78b3fe9ecf7d7724dbb2f24c5d42
      size: 52364567
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          nb_epoch: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/combined/clean.csv
      md5: f98a73cd05f4f32202be793e63202b80
      size: 37125895
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file data/combined/combined.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder plots/combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      md5: 26e5e54acb8aec5ef5c1eb10d0e38184
      size: 11134
    - path: plots/combined/clean.csv
      md5: f98a73cd05f4f32202be793e63202b80
      size: 37125895
    outs:
    - path: plots/combined/aft_comparison.csv
      md5: 8a4f7984ce546ef017451da9afc94ef3
      size: 479
    - path: plots/combined/aft_comparison.tex
      md5: 6e15bc8939073117ee08c8373be5a15f
      size: 681
    - path: plots/combined/cox_aft.pdf
      md5: 9e6fa08f4a4ebafbe0bac7d6e266abcb
      size: 20697
    - path: plots/combined/cox_attack_eps_partial_effect.pdf
      md5: 5ddd5ba7d1f04ba8ab14f641f191780e
      size: 38648
    - path: plots/combined/cox_batch_size_partial_effect.pdf
      md5: d1bfe07774717d0d66cec78d4561c075
      size: 42121
    - path: plots/combined/cox_epochs_partial_effect.pdf
      md5: f2739f3df9dd5b90b5541a3d72b3f57c
      size: 41741
    - path: plots/combined/cox_predict_time_partial_effect.pdf
      md5: 6b0f2fa3e849c0a5bcb68c176aa5635e
      size: 38307
    - path: plots/combined/cox_train_time_partial_effect.pdf
      md5: 8d348deb69059f5e56c1582bc245c258
      size: 38687
    - path: plots/combined/log_logistic_aft.pdf
      md5: eaccc7eb380bf3fc99b99ec63933abd2
      size: 22606
    - path: plots/combined/log_logistic_attack_eps_partial_effect.pdf
      md5: 5f969cc57402c34c4c0aca1e2eed1747
      size: 27053
    - path: plots/combined/log_logistic_batch_size_partial_effect.pdf
      md5: 3aa8264388919765719e2ee40a717e44
      size: 28454
    - path: plots/combined/log_logistic_epochs_partial_effect.pdf
      md5: 5e9a3a7e87e5daa67ba70423e01c1d24
      size: 27731
    - path: plots/combined/log_logistic_predict_time_partial_effect.pdf
      md5: 6e19dd0b475e1e885fc1d943b8e81aa2
      size: 26724
    - path: plots/combined/log_logistic_train_time_partial_effect.pdf
      md5: daafaad86f17dbfd9c4c5f7fd4270688
      size: 24776
    - path: plots/combined/log_normal_aft.pdf
      md5: 0ec827bced5e0df259038f6f62587140
      size: 23195
    - path: plots/combined/log_normal_attack_eps_partial_effect.pdf
      md5: e1a45d7bf9855dec4e588c3af0a08b79
      size: 27783
    - path: plots/combined/log_normal_batch_size_partial_effect.pdf
      md5: 6df8b191b9ff9d4ce60bf283468254ec
      size: 29364
    - path: plots/combined/log_normal_epochs_partial_effect.pdf
      md5: fc47087ee5959872ac32189187f3665a
      size: 28563
    - path: plots/combined/log_normal_predict_time_partial_effect.pdf
      md5: 7b2a37249854a2bdb26c52e0314c9829
      size: 27461
    - path: plots/combined/log_normal_train_time_partial_effect.pdf
      md5: c2319528d28c6efad2f972ecb989c788
      size: 25599
    - path: plots/combined/weibull_aft.pdf
      md5: 595eba434a5e92792b15cd0596dd72dd
      size: 30159
    - path: plots/combined/weibull_attack_eps_partial_effect.pdf
      md5: febeba76c9e65f7ff3576e45464a51a7
      size: 26669
    - path: plots/combined/weibull_batch_size_partial_effect.pdf
      md5: e08832f29dce35e9d818f9516c5771b2
      size: 28288
    - path: plots/combined/weibull_epochs_partial_effect.pdf
      md5: ecc7e8bf92c52f28bee71eed336223ae
      size: 27785
    - path: plots/combined/weibull_predict_time_partial_effect.pdf
      md5: adffa564e781ccace709e7eac0a54552
      size: 26347
    - path: plots/combined/weibull_train_time_partial_effect.pdf
      md5: 85a2c1251f6bf2700e5b2df2fb337888
      size: 24276
