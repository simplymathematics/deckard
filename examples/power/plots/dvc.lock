schema: '2.0'
stages:
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/mnist/power.csv
      hash: md5
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5421537
    - path: data/mnist/power.csv
      hash: md5
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9968081
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar/power.csv
      hash: md5
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5291011
    - path: data/cifar/power.csv
      hash: md5
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9997291
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder cifar100/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar100/power.csv
      hash: md5
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3987447
    - path: data/cifar100/power.csv
      hash: md5
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16081846
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i mnist/merged.csv --o mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.np_epochs
          Batch_Size: model.trainer.batch_size
    outs:
    - path: mnist/clean.csv
      hash: md5
      md5: 4dfbcdb8c5aa27976ec2811ea9c1fda6
      size: 9294911
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i cifar/merged.csv --o cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.np_epochs
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar/clean.csv
      hash: md5
      md5: c546fa08ebcc159fd81fcaa5dda11411
      size: 9305692
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i cifar100/merged.csv --o cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.np_epochs
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar100/clean.csv
      hash: md5
      md5: d020a3f4406f0f6091ea8f09ea67b824
      size: 9318360
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: mnist/clean.csv
      hash: md5
      md5: 4dfbcdb8c5aa27976ec2811ea9c1fda6
      size: 9294911
    outs:
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: 7cf6100c4a63fafce26ec0dabe60b7dc
      size: 258
    - path: mnist/aft_comparison.tex
      hash: md5
      md5: aca171194f34f77b26ce81432f0be23a
      size: 534
    - path: mnist/cox_aft.pdf
      hash: md5
      md5: 6cf343a6c73d2e39f953071e761011c5
      size: 22648
    - path: mnist/cox_epochs_partial_effect.pdf
      hash: md5
      md5: ca0df1707b223c591e51c6092d677d9b
      size: 29247
    - path: mnist/log_logistic_aft.pdf
      hash: md5
      md5: dfa718e8ee09a14efe19dbf16c468d56
      size: 23673
    - path: mnist/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 8540d0206d466bcafca2581ce87c40ee
      size: 27441
    - path: mnist/log_normal_aft.pdf
      hash: md5
      md5: 7d7fbda03eafc9b1e881c0469be93f40
      size: 24069
    - path: mnist/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 6f0fa989d40cd3d12453594e325c9a1f
      size: 28250
    - path: mnist/weibull_aft.pdf
      hash: md5
      md5: 27b4ba3c41bc2f01227f80cb5251101a
      size: 23671
    - path: mnist/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 2ec56ba18ab0446bda375509fa74f5dc
      size: 27137
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar/clean.csv
      hash: md5
      md5: c546fa08ebcc159fd81fcaa5dda11411
      size: 9305692
    outs:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 8e5d3667cfffeb11a7ab923429ca606a
      size: 263
    - path: cifar/aft_comparison.tex
      hash: md5
      md5: ae1a73e2065bb6707bbf12281c077291
      size: 535
    - path: cifar/cox_aft.pdf
      hash: md5
      md5: 60ebd0500a1fe6a30e02084bafaee691
      size: 22303
    - path: cifar/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 2c71d7194f9c54a7e3fb972b90b7670a
      size: 29601
    - path: cifar/log_logistic_aft.pdf
      hash: md5
      md5: accd69a47f040740316a10fbccd15105
      size: 23671
    - path: cifar/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: d4719975431aed2a2bb184038e88c621
      size: 28014
    - path: cifar/log_normal_aft.pdf
      hash: md5
      md5: 6c8be4e785288cbdd92f405e85b7c7ac
      size: 24075
    - path: cifar/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 2d847fcb77e0242e7640557f85413402
      size: 28659
    - path: cifar/weibull_aft.pdf
      hash: md5
      md5: a16749a3658eb60911fafa742b5d9395
      size: 23676
    - path: cifar/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 731486b0d77ffe3c1a10e9266889badc
      size: 27620
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar100/clean.csv
      hash: md5
      md5: d020a3f4406f0f6091ea8f09ea67b824
      size: 9318360
    outs:
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: af5fb567ef3c24779630f0b674863d46
      size: 264
    - path: cifar100/aft_comparison.tex
      hash: md5
      md5: 55433d5ecef94bc9c649b1cfbac52071
      size: 536
    - path: cifar100/cox_aft.pdf
      hash: md5
      md5: 35ea7e276dd37b2654f9ca879a03f135
      size: 22290
    - path: cifar100/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 0754f4454cac185238a8ca0c0f4ef9f6
      size: 33010
    - path: cifar100/log_logistic_aft.pdf
      hash: md5
      md5: 0d01170bd1c2524d8a191217377a337f
      size: 23679
    - path: cifar100/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 8fc02cf3bb19feb5c374ce42546a158c
      size: 27770
    - path: cifar100/log_normal_aft.pdf
      hash: md5
      md5: 3d2a77921049b8094cea1ba42f4f3267
      size: 24078
    - path: cifar100/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 6eed47f6dd64ff0ebb7d452af2d81052
      size: 28693
    - path: cifar100/weibull_aft.pdf
      hash: md5
      md5: fe52aa7910c2e97d448499d07b655700
      size: 23666
    - path: cifar100/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: a5b7cafd33b9fa31dc90b77db05e0165
      size: 27319
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 8e5d3667cfffeb11a7ab923429ca606a
      size: 263
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: af5fb567ef3c24779630f0b674863d46
      size: 264
    - path: combined_plots.py
      hash: md5
      md5: 7ea9df483b87b41bbe1195b55275bd6c
      size: 7724
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: 7cf6100c4a63fafce26ec0dabe60b7dc
      size: 258
    outs:
    - path: combined/acc.pdf
      hash: md5
      md5: 6887b091b83c375be8c81d5c64973b7e
      size: 30384
    - path: combined/cost.pdf
      hash: md5
      md5: 8450471bfedb2f535a868435dfe68d47
      size: 39894
    - path: combined/power.pdf
      hash: md5
      md5: 53da512ffda57bd846e756be51430d49
      size: 40084
    - path: combined/time.pdf
      hash: md5
      md5: 4c3a1fad66932c3ad2b093534551f2c3
      size: 40216
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.np_epochs
          Batch_Size: model.trainer.batch_size
    outs:
    - path: combined/clean.csv
      hash: md5
      md5: 0c16036112b442a00cff7f91411fb07d
      size: 37306094
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 1deda0b091aac0cc406453185271c97e
      size: 4505
    - path: combined/clean.csv
      hash: md5
      md5: 0c16036112b442a00cff7f91411fb07d
      size: 37306094
    outs:
    - path: combined/aft_comparison.csv
      hash: md5
      md5: f0296039b0f7f1ea537a10a3de5c9b81
      size: 238
    - path: combined/aft_comparison.tex
      hash: md5
      md5: f125f5ad936db3c9a1c20432b425a795
      size: 489
    - path: combined/log_logistic_aft.pdf
      hash: md5
      md5: 414ad5b58384b570e73b009776aec55b
      size: 26799
    - path: combined/log_logistic_aft_dummies.pdf
      hash: md5
      md5: 43eaa4999b0dc48296d2ae1261d6621b
      size: 24362
    - path: combined/log_logistic_qq.pdf
      hash: md5
      md5: de98afb708b08acd57561fcc7b468a71
      size: 20770
    - path: combined/log_logistic_summary.csv
      hash: md5
      md5: e89252783f5b8e44efe165632dfd51e6
      size: 3393
    - path: combined/log_normal_aft.pdf
      hash: md5
      md5: 5299f736bc524ea10dddda7b68feba60
      size: 26912
    - path: combined/log_normal_aft_dummies.pdf
      hash: md5
      md5: d225a60cc7c433d9ff62113e42c07c2a
      size: 24760
    - path: combined/log_normal_qq.pdf
      hash: md5
      md5: c589021c809e186438ce543e4afef58a
      size: 22475
    - path: combined/log_normal_summary.csv
      hash: md5
      md5: fc44e385df146e969bcad89fa9b5bc44
      size: 3349
    - path: combined/weibull_aft.pdf
      hash: md5
      md5: 6bf6572c0e6a793259306b3762eb0bcf
      size: 26996
    - path: combined/weibull_aft_dummies.pdf
      hash: md5
      md5: dac28c7790653630b806056435d161b7
      size: 24361
    - path: combined/weibull_qq.pdf
      hash: md5
      md5: 3f862fe7fac70b1a989b552d1aeb4852
      size: 20533
    - path: combined/weibull_summary.csv
      hash: md5
      md5: 021bd0236ee988f89633606ac6152804
      size: 3413
  copy@mnist:
    cmd: rm -rf ~/kepler-ml/plots/mnist/ && mkdir -p ~/kepler-ml/plots/mnist/ && cp
      -r mnist/* ~/kepler-ml/plots/mnist/
    deps:
    - path: mnist/
      hash: md5
      md5: 5a2da96ca7e0fcdee2ea31522675f4c7.dir
      size: 25107819
      nfiles: 21
  copy@cifar:
    cmd: rm -rf ~/kepler-ml/plots/cifar/ && mkdir -p ~/kepler-ml/plots/cifar/ && cp
      -r cifar/* ~/kepler-ml/plots/cifar/
    deps:
    - path: cifar/
      hash: md5
      md5: fe364ed42297c19f60b48e9775b913c0.dir
      size: 24910643
      nfiles: 20
  copy@cifar100:
    cmd: rm -rf ~/kepler-ml/plots/cifar100/ && mkdir -p ~/kepler-ml/plots/cifar100/
      && cp -r cifar100/* ~/kepler-ml/plots/cifar100/
    deps:
    - path: cifar100/
      hash: md5
      md5: 3e4f3b8aad2d77de6f7fff32aaea49c7.dir
      size: 29721403
      nfiles: 20
  copy@combined:
    cmd: rm -rf ~/kepler-ml/plots/combined/ && mkdir -p ~/kepler-ml/plots/combined/
      && cp -r combined/* ~/kepler-ml/plots/combined/
    deps:
    - path: combined/
      hash: md5
      md5: 1b15716951d56f93bb2892ad68959f9e.dir
      size: 37685542
      nfiles: 20
