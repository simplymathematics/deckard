schema: '2.0'
stages:
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder cifar100/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar100/power.csv
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3987447
    - path: data/cifar100/power.csv
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16081846
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i cifar100/merged.csv --o cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
    outs:
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: b7c15ae615a33408a0b727601cab890a
      size: 212
    - path: cifar100/aft_comparison.tex
      hash: md5
      md5: 3466f7e3a4024d83bbaa2ccc7b13da80
      size: 472
    - path: cifar100/cox_aft.pdf
      hash: md5
      md5: a1f7eb62a47e7534801aeb1c2c0511f9
      size: 28926
    - path: cifar100/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 7c201567d7a3edc6aecb7972ae450c18
      size: 33262
    - path: cifar100/log_logistic_aft.pdf
      hash: md5
      md5: bf34c8fb1ac01bdec23e963fcfa1bfaf
      size: 29307
    - path: cifar100/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: db68e1ac135a0c9192107f55e5465004
      size: 27155
    - path: cifar100/log_normal_aft.pdf
      hash: md5
      md5: 79fb71551e5b2b5cfb4e4e542fd4c25b
      size: 29841
    - path: cifar100/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: d55150077ad1defa3f56c09df48fc5e4
      size: 27993
    - path: cifar100/weibull_aft.pdf
      hash: md5
      md5: 53930c654da1f611776105e0275bcac1
      size: 29018
    - path: cifar100/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: d6444f2b2d7e340ef4c9825549f43fa4
      size: 28027
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar/power.csv
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5291011
    - path: data/cifar/power.csv
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9997291
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/mnist/power.csv
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5421537
    - path: data/mnist/power.csv
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9968081
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i mnist/merged.csv --o mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
    outs:
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: 83bac6dcedac880fa889c4eb997ef11b
      size: 207
    - path: mnist/aft_comparison.tex
      hash: md5
      md5: 030489512539372044c8f958ce6bab22
      size: 467
    - path: mnist/cox_aft.pdf
      hash: md5
      md5: 92f5fa02c6675287200405c286c685d3
      size: 28581
    - path: mnist/cox_epochs_partial_effect.pdf
      hash: md5
      md5: eaec5429a59014efbfed766c46a86d39
      size: 32663
    - path: mnist/log_logistic_aft.pdf
      hash: md5
      md5: 54d8f35550ce43283e2c98e40a5acc83
      size: 29342
    - path: mnist/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 054afbdc20bc57e70974794759ab9d6f
      size: 27325
    - path: mnist/log_normal_aft.pdf
      hash: md5
      md5: a8360882fa3a413208efaaa65b274660
      size: 29874
    - path: mnist/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: c16d78b0d8d20f3fcfa8f9a634de831f
      size: 28077
    - path: mnist/weibull_aft.pdf
      hash: md5
      md5: 3aa1db789188dee8ef845679db617f9b
      size: 29062
    - path: mnist/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: e7eeec1f3f63141d64bb5fd12c1f0f4a
      size: 26910
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i cifar/merged.csv --o cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
    outs:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 42dad9a57c0b74eee3caffbd85e177d0
      size: 211
    - path: cifar/aft_comparison.tex
      hash: md5
      md5: 112fb42d06cc47aee03cf203865133bf
      size: 471
    - path: cifar/cox_aft.pdf
      hash: md5
      md5: 39d4ba484093e82305df65b723f0995e
      size: 28935
    - path: cifar/cox_epochs_partial_effect.pdf
      hash: md5
      md5: fabcf89808fec2ea0a26a589b450368c
      size: 33196
    - path: cifar/log_logistic_aft.pdf
      hash: md5
      md5: dfc5917b1ef4090011266eb411f6e45a
      size: 29703
    - path: cifar/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 434f0e882200d093f56f8a4af792a1a4
      size: 27433
    - path: cifar/log_normal_aft.pdf
      hash: md5
      md5: 357c5bac29d6ac16a5134002d58ab71d
      size: 30232
    - path: cifar/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 77286234618d5ea26d2ed51f59a44b11
      size: 28162
    - path: cifar/weibull_aft.pdf
      hash: md5
      md5: 79c5dbd6207a9cfac6a306e803d76d5e
      size: 28724
    - path: cifar/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 031f361318d485d5d5de189f97e67d23
      size: 28030
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 42dad9a57c0b74eee3caffbd85e177d0
      size: 211
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: b7c15ae615a33408a0b727601cab890a
      size: 212
    - path: combined_plots.py
      hash: md5
      md5: 7ea9df483b87b41bbe1195b55275bd6c
      size: 7724
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: 83bac6dcedac880fa889c4eb997ef11b
      size: 207
    outs:
    - path: combined/acc.pdf
      hash: md5
      md5: a5490138fd27f82247f8a9bc6085548d
      size: 30390
    - path: combined/cost.pdf
      hash: md5
      md5: cd73aaaa20632dbfd01d7db5eede6216
      size: 39900
    - path: combined/power.pdf
      hash: md5
      md5: add552e41f85cc6b1d3323ebfcb7d586
      size: 40090
    - path: combined/time.pdf
      hash: md5
      md5: aad9d951ea6ada23ddda5abf26837007
      size: 40222
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: combined/clean.csv
      hash: md5
      md5: 24f49787a6d20f9172dacf9edefff85f
      size: 37298176
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 068c842adac014ff65cbf74d28e57263
      size: 8923
    - path: combined/clean.csv
      hash: md5
      md5: 24f49787a6d20f9172dacf9edefff85f
      size: 37298176
    outs:
    - path: combined/aft_comparison.csv
      hash: md5
      md5: 238ff959f5768d165bddb38595db5d37
      size: 188
    - path: combined/aft_comparison.tex
      hash: md5
      md5: 14bc20405c6aadb2dfc4e421cd38ca10
      size: 435
    - path: combined/log_logistic_aft.pdf
      hash: md5
      md5: aac13f3cf63ac5465745fe4d9259fb26
      size: 26842
    - path: combined/log_logistic_attack_eps_partial_effect.pdf
      hash: md5
      md5: 8e01bb3f47b6b6f8f6833fb9c95fc7b7
      size: 26868
    - path: combined/log_logistic_batch_size_partial_effect.pdf
      hash: md5
      md5: 1d44104e16588977beb7fda99c22ffe9
      size: 28790
    - path: combined/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 93c151ac35c314013d1bdada7586556d
      size: 27938
    - path: combined/log_logistic_qq.pdf
      hash: md5
      md5: 7efc380110b905cc78512130f6d83818
      size: 18398
    - path: combined/log_logistic_summary.csv
      hash: md5
      md5: c0cbc323a723516dbd3087bb9440caf1
      size: 3486
    - path: combined/log_logistic_summary.pdf
      hash: md5
      md5: 9ffa41e41bfe360feebc573016f6f097
      size: 24177
    - path: combined/log_normal_aft.pdf
      hash: md5
      md5: a78e3c9421c76882edfe902d932e9ff8
      size: 27359
    - path: combined/log_normal_attack_eps_partial_effect.pdf
      hash: md5
      md5: c59ae22e10afd6d2eac0a93a17eea1b1
      size: 27579
    - path: combined/log_normal_batch_size_partial_effect.pdf
      hash: md5
      md5: 99acceed3b248fc591eb6ffa875a1823
      size: 29598
    - path: combined/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: aa2799f11fdb6a6c3dbc4fb95cf8f04e
      size: 28603
    - path: combined/log_normal_qq.pdf
      hash: md5
      md5: 7ff143b84d569b5866e3b74753e2aea8
      size: 19371
    - path: combined/log_normal_summary.csv
      hash: md5
      md5: 9025cfe2f47a1a1aa0d9fb3575072712
      size: 3445
    - path: combined/log_normal_summary.pdf
      hash: md5
      md5: e3d279b697de53a36bafa967181e8534
      size: 23588
    - path: combined/weibull_aft.pdf
      hash: md5
      md5: dfc0bcd0bea352ef30e6f039b4302928
      size: 26881
    - path: combined/weibull_attack_eps_partial_effect.pdf
      hash: md5
      md5: b7bf5aa1df5dd9ad15b6cb3b1c4d8b51
      size: 26258
    - path: combined/weibull_batch_size_partial_effect.pdf
      hash: md5
      md5: d230a0b5e28f9ba708871f5108c769f0
      size: 28543
    - path: combined/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: a11fb614b4c7d550d37f97bf440a1391
      size: 27623
    - path: combined/weibull_qq.pdf
      hash: md5
      md5: bdb4fc835e46a383077f2ca5c1aaeb06
      size: 17754
    - path: combined/weibull_summary.csv
      hash: md5
      md5: 60e0589a5a15d42dff93363a7eb4321d
      size: 3496
    - path: combined/weibull_summary.pdf
      hash: md5
      md5: dd6f108b562914e233db34725411b861
      size: 23246
  copy@mnist:
    cmd: rm -rf ~/kepler-ml/plots/mnist/ && mkdir -p ~/kepler-ml/plots/mnist/ && cp
      -r mnist/* ~/kepler-ml/plots/mnist/
    deps:
    - path: mnist/
      hash: md5
      md5: 471393aafa68242f56f1ea89deee3e12.dir
      size: 25117170
      nfiles: 24
  copy@cifar:
    cmd: rm -rf ~/kepler-ml/plots/cifar/ && mkdir -p ~/kepler-ml/plots/cifar/ && cp
      -r cifar/* ~/kepler-ml/plots/cifar/
    deps:
    - path: cifar/
      hash: md5
      md5: f5f2e55caf8ef48d118b671826681059.dir
      size: 25026421
      nfiles: 24
  copy@cifar100:
    cmd: rm -rf ~/kepler-ml/plots/cifar100/ && mkdir -p ~/kepler-ml/plots/cifar100/
      && cp -r cifar100/* ~/kepler-ml/plots/cifar100/
    deps:
    - path: cifar100/
      hash: md5
      md5: 3d869171891160bc451bd2e67407358e.dir
      size: 29834315
      nfiles: 24
  copy@combined:
    cmd: rm -rf ~/kepler-ml/plots/combined/ && mkdir -p ~/kepler-ml/plots/combined/
      && cp -r combined/* ~/kepler-ml/plots/combined/
    deps:
    - path: combined/
      hash: md5
      md5: b470d85ae3744a8888f1b27504f3df26.dir
      size: 38101315
      nfiles: 35
