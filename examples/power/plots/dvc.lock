schema: '2.0'
stages:
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder plots/cifar100/
      --output_file merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 128f80b1d68a0539c43eac550665b658
      size: 538
    - path: data/bit_depth/cifar100/power.csv
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3988195
    - path: data/cifar100/power.csv
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16085014
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/cifar100/merged.csv
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i plots/cifar100/merged.csv --o plots/cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 128f80b1d68a0539c43eac550665b658
      size: 538
    - path: plots/cifar100/merged.csv
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20103676
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file plots/cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: b603b53ec2f4c9401dd7134174b31fe7
      size: 4853
    - path: plots/cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
    outs:
    - path: plots/cifar100/aft_comparison.csv
      hash: md5
      md5: 92926e455d4e91fe0c4677df1ebd4359
      size: 457
    - path: plots/cifar100/aft_comparison.tex
      hash: md5
      md5: ec77d0de0c6b9266c464495cb35910bb
      size: 473
    - path: plots/cifar100/cox_aft.pdf
      hash: md5
      md5: 1bd4a66b3edc78d637ea7f14848dc2d2
      size: 20038
    - path: plots/cifar100/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 1f5910143e78c3f8f3562ccf7feafb2f
      size: 33464
    - path: plots/cifar100/log_logistic_aft.pdf
      hash: md5
      md5: c4377e78ab6d43cec205ef2845e11347
      size: 21953
    - path: plots/cifar100/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: a15e5a26b21f99810b04fe17c88717e3
      size: 28394
    - path: plots/cifar100/log_normal_aft.pdf
      hash: md5
      md5: 42616e9c02fb9ee5102b9f2444b17c48
      size: 22363
    - path: plots/cifar100/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 08e2f0e38439c45880e7f273954dc191
      size: 29246
    - path: plots/cifar100/weibull_aft.pdf
      hash: md5
      md5: f530413572b826f3d547ec659fad643d
      size: 28925
    - path: plots/cifar100/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 2fb0ec2e0a9359e60246f0b30452ac19
      size: 28182
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder plots/cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 128f80b1d68a0539c43eac550665b658
      size: 538
    - path: data/bit_depth/cifar/power.csv
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5292031
    - path: data/cifar/power.csv
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9999301
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/cifar/merged.csv
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder plots/mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 128f80b1d68a0539c43eac550665b658
      size: 538
    - path: data/bit_depth/mnist/power.csv
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5422584
    - path: data/mnist/power.csv
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9970090
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/mnist/merged.csv
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i plots/mnist/merged.csv --o plots/mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 128f80b1d68a0539c43eac550665b658
      size: 538
    - path: plots/mnist/merged.csv
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15411588
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file plots/mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: b603b53ec2f4c9401dd7134174b31fe7
      size: 4853
    - path: plots/mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
    outs:
    - path: plots/mnist/aft_comparison.csv
      hash: md5
      md5: ab3f676472c98796bdc4dc3daaa5e48e
      size: 460
    - path: plots/mnist/aft_comparison.tex
      hash: md5
      md5: 86718858762a42609ea12da417c5f32d
      size: 471
    - path: plots/mnist/cox_aft.pdf
      hash: md5
      md5: eb2e0e0f1d539a37d7b0b49576480840
      size: 19690
    - path: plots/mnist/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 8cf2dc48d0ac029ee8eb04d0a65d7e79
      size: 32796
    - path: plots/mnist/log_logistic_aft.pdf
      hash: md5
      md5: a77dc307f5ae0258404ee46e759dc794
      size: 21989
    - path: plots/mnist/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 487256d4ae6af84fef7f286b57410ee0
      size: 28476
    - path: plots/mnist/log_normal_aft.pdf
      hash: md5
      md5: a6510e6544f7b695a36851f92027c95b
      size: 22386
    - path: plots/mnist/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 31685d3897950da24cb2c034c52180b5
      size: 29384
    - path: plots/mnist/weibull_aft.pdf
      hash: md5
      md5: 8193607f143d6dd34ce32c6ae8b2de3f
      size: 28954
    - path: plots/mnist/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 8a568e497ef6e378af2ea131251c6095
      size: 28201
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i plots/cifar/merged.csv --o plots/cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 128f80b1d68a0539c43eac550665b658
      size: 538
    - path: plots/cifar/merged.csv
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15307632
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file plots/cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: b603b53ec2f4c9401dd7134174b31fe7
      size: 4853
    - path: plots/cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
    outs:
    - path: plots/cifar/aft_comparison.csv
      hash: md5
      md5: ea5293240bf677b0154751b25cd1d44c
      size: 459
    - path: plots/cifar/aft_comparison.tex
      hash: md5
      md5: 278b79efec90de78585f431345f42b44
      size: 469
    - path: plots/cifar/cox_aft.pdf
      hash: md5
      md5: 27b51a04dae239d28eef56409c2f0e4a
      size: 20044
    - path: plots/cifar/cox_epochs_partial_effect.pdf
      hash: md5
      md5: bd5c6804ba33badbcda68355e932da11
      size: 33320
    - path: plots/cifar/log_logistic_aft.pdf
      hash: md5
      md5: aa912e0b27861ab7b3f78866d687c036
      size: 21647
    - path: plots/cifar/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 0ac751e049735eaf168ec3dd185dac77
      size: 28641
    - path: plots/cifar/log_normal_aft.pdf
      hash: md5
      md5: 662540eeffcf9fb2c087c86a10a55418
      size: 22747
    - path: plots/cifar/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: dfeaeb95e7bb0a1b3a5c8db5d7893ee6
      size: 29375
    - path: plots/cifar/weibull_aft.pdf
      hash: md5
      md5: f42add5f7c54d611cc890acd8a2a5d28
      size: 28614
    - path: plots/cifar/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: f00f00e0830d6d56a49232127857db66
      size: 28261
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: combined_plots.py
      hash: md5
      md5: 63aee34353b85d86201970a2d578e6ee
      size: 7437
    - path: plots/cifar/aft_comparison.csv
      hash: md5
      md5: ea5293240bf677b0154751b25cd1d44c
      size: 459
    - path: plots/cifar100/aft_comparison.csv
      hash: md5
      md5: 92926e455d4e91fe0c4677df1ebd4359
      size: 457
    - path: plots/mnist/aft_comparison.csv
      hash: md5
      md5: ab3f676472c98796bdc4dc3daaa5e48e
      size: 460
    outs:
    - path: data/combined/combined.csv
      md5: 493c48e49102ccf2dcc55e6513c2d617
      size: 52354571
    - path: plots/combined/acc.pdf
      hash: md5
      md5: 2db6effd7bb30b165d0d66671a4abb18
      size: 33985
    - path: plots/combined/cost.pdf
      hash: md5
      md5: 2c2072acf3349570df9730d18bc60314
      size: 44260
    - path: plots/combined/power.pdf
      hash: md5
      md5: 40e3232cc4866be1aac9ca24d5ddf68f
      size: 44329
    - path: plots/combined/time.pdf
      hash: md5
      md5: 07ff52eb3fc179e310dcd7901e5b70c4
      size: 44062
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o plots/combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 128f80b1d68a0539c43eac550665b658
      size: 538
    - path: data/combined/combined.csv
      md5: 493c48e49102ccf2dcc55e6513c2d617
      size: 52364568
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/combined/clean.csv
      hash: md5
      md5: f8eda4987668d731aca17c6ec412b78b
      size: 37117987
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file plots/combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder plots/combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 653f1b168624f734caf8159732cf2dae
      size: 11134
    - path: plots/combined/clean.csv
      hash: md5
      md5: f8eda4987668d731aca17c6ec412b78b
      size: 37117987
    outs:
    - path: plots/combined/aft_comparison.csv
      hash: md5
      md5: c3e5d67c48077727cd335792ff149d31
      size: 480
    - path: plots/combined/aft_comparison.tex
      hash: md5
      md5: 05a863a81bad95931af7ca6b2706486a
      size: 492
    - path: plots/combined/cox_aft.pdf
      hash: md5
      md5: 6ac083aca5c42978b341736a4c93e745
      size: 20047
    - path: plots/combined/cox_attack_eps_partial_effect.pdf
      hash: md5
      md5: 87f93fe83c1510c121fb6d6788fb1b88
      size: 32753
    - path: plots/combined/cox_batch_size_partial_effect.pdf
      hash: md5
      md5: 4f1c5eb31b35f693b131f3cb61294174
      size: 36913
    - path: plots/combined/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 281b7e3e64275c35d914ba3e3e54db65
      size: 36515
    - path: plots/combined/cox_predict_time_partial_effect.pdf
      hash: md5
      md5: 07a582bc6eb80b3262869678477c39b0
      size: 32413
    - path: plots/combined/cox_train_time_partial_effect.pdf
      hash: md5
      md5: b899520da16767143eb0495249c5d1b9
      size: 33392
    - path: plots/combined/log_logistic_aft.pdf
      hash: md5
      md5: 75252cbbd217de184fa256819fda89f0
      size: 21839
    - path: plots/combined/log_logistic_attack_eps_partial_effect.pdf
      hash: md5
      md5: 9c105895bd1fe86f650f45f1899b6087
      size: 26726
    - path: plots/combined/log_logistic_batch_size_partial_effect.pdf
      hash: md5
      md5: c5560a0183294842745da5750af7f8e7
      size: 29002
    - path: plots/combined/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 15c1694e5dd4f4caca79a316295912a7
      size: 29195
    - path: plots/combined/log_logistic_predict_time_partial_effect.pdf
      hash: md5
      md5: 326fb1c59ade68b85e0b700194a3c5d8
      size: 26395
    - path: plots/combined/log_logistic_train_time_partial_effect.pdf
      hash: md5
      md5: 2016e91d6073693533bd017083c6c6b0
      size: 25328
    - path: plots/combined/log_normal_aft.pdf
      hash: md5
      md5: 066eb5c6078d7a62c8e6f60d7e7fee1c
      size: 22435
    - path: plots/combined/log_normal_attack_eps_partial_effect.pdf
      hash: md5
      md5: 319d83ae6f3b37dc164d2c1212cc6ae2
      size: 27515
    - path: plots/combined/log_normal_batch_size_partial_effect.pdf
      hash: md5
      md5: 3ae858cae3fd36376d3e3971e054b8c0
      size: 29852
    - path: plots/combined/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: b83f5ac0fb9920c9b71da70a3ccd6826
      size: 29946
    - path: plots/combined/log_normal_predict_time_partial_effect.pdf
      hash: md5
      md5: 282766045f34970078e1d8fd8de74f6f
      size: 27182
    - path: plots/combined/log_normal_train_time_partial_effect.pdf
      hash: md5
      md5: 1fd1b2c1eea50db35f317d26b8e6fdf3
      size: 26178
    - path: plots/combined/weibull_aft.pdf
      hash: md5
      md5: b1ad1a3ab3f3e972ac9f8e08fc4e8638
      size: 28818
    - path: plots/combined/weibull_attack_eps_partial_effect.pdf
      hash: md5
      md5: f07a292b23eda625e1b4ae41dd9f6285
      size: 26346
    - path: plots/combined/weibull_batch_size_partial_effect.pdf
      hash: md5
      md5: 37300e03e880f39f44bbb7fd75f829ad
      size: 28851
    - path: plots/combined/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 25691bb1383d5da46198669aa3ffd930
      size: 29016
    - path: plots/combined/weibull_predict_time_partial_effect.pdf
      hash: md5
      md5: a77e46667d584b53e922c7d4fd4ccef9
      size: 26015
    - path: plots/combined/weibull_train_time_partial_effect.pdf
      hash: md5
      md5: b2eb4be74d8384813fbc47ae4c0d7dc8
      size: 25030
