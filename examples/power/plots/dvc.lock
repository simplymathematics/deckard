schema: '2.0'
stages:
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder cifar100/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar100/power.csv
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3987447
    - path: data/cifar100/power.csv
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16081846
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i cifar100/merged.csv --o cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
    outs:
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: 2257bff05cc3b1fbb36f3a73ccb90b78
      size: 271
    - path: cifar100/aft_comparison.tex
      hash: md5
      md5: d6648c4e2c632ab5b54354d8ea61b8a4
      size: 530
    - path: cifar100/cox_aft.pdf
      hash: md5
      md5: 9a20be4d8a7ba0972595f38a67e60235
      size: 32152
    - path: cifar100/cox_epochs_partial_effect.pdf
      hash: md5
      md5: f9fcbdf407d7c9d56a2454692fdae1bd
      size: 33262
    - path: cifar100/log_logistic_aft.pdf
      hash: md5
      md5: ef7565193224d37495079be860534763
      size: 34138
    - path: cifar100/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: be20812c13584796444702d1af43c8af
      size: 27110
    - path: cifar100/log_normal_aft.pdf
      hash: md5
      md5: 3cc4acbfe69718aa196532d90834e313
      size: 36607
    - path: cifar100/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 929320c0cf4e235a44afd8383f55a3f9
      size: 27990
    - path: cifar100/weibull_aft.pdf
      hash: md5
      md5: d8618fb387e7c85479b19548e6220e99
      size: 34233
    - path: cifar100/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 12652d663bc6404d0baaabc85f7f0871
      size: 27982
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar/power.csv
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5291011
    - path: data/cifar/power.csv
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9997291
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/mnist/power.csv
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5421537
    - path: data/mnist/power.csv
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9968081
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i mnist/merged.csv --o mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
    outs:
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: ad80e3681729313ec97819530d1cdd42
      size: 269
    - path: mnist/aft_comparison.tex
      hash: md5
      md5: a07cff330b81c54a7f0013938df8a65e
      size: 524
    - path: mnist/cox_aft.pdf
      hash: md5
      md5: 920c1e03e024d507c659ad515d941406
      size: 31798
    - path: mnist/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 879987df1d9576fd1e7e64075c759199
      size: 32663
    - path: mnist/log_logistic_aft.pdf
      hash: md5
      md5: a6a42df85fb2740525cdd24f90d1d958
      size: 34388
    - path: mnist/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: e7a1024bf5711b1bb6894f8b02a095ad
      size: 27213
    - path: mnist/log_normal_aft.pdf
      hash: md5
      md5: af07ade8cc413c777936d7fe859f4a68
      size: 36004
    - path: mnist/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 9705991df4b2241a1bd4147d8ce1217a
      size: 28114
    - path: mnist/weibull_aft.pdf
      hash: md5
      md5: 89cf11db7c661a1d22b3f62e9f072481
      size: 33870
    - path: mnist/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 0aa3d0c8b7a5e4f383d27a812d088111
      size: 26912
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i cifar/merged.csv --o cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
    outs:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 2227175517da80ba886a0074154ed1b9
      size: 270
    - path: cifar/aft_comparison.tex
      hash: md5
      md5: 9722d9549efabb9cca237c5b4b98a440
      size: 524
    - path: cifar/cox_aft.pdf
      hash: md5
      md5: d5edfeb0291af42ff2fd3cfdfb664554
      size: 32165
    - path: cifar/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 4cdc932bc4d01b83bb38bbc71968bac1
      size: 33196
    - path: cifar/log_logistic_aft.pdf
      hash: md5
      md5: 088e71029a7cff65cf3ceb6c263952d8
      size: 34161
    - path: cifar/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 98de225c30a610cd81cd6fe96f25b554
      size: 27406
    - path: cifar/log_normal_aft.pdf
      hash: md5
      md5: b31b503b98648af6342a68e329fdca29
      size: 36603
    - path: cifar/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: b41fe0dbadb14fc98ee4dcb20a43b4a7
      size: 28108
    - path: cifar/weibull_aft.pdf
      hash: md5
      md5: 155df863028296856bd080794542f77a
      size: 33881
    - path: cifar/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: de43e7081c5b6bc34407132fba234551
      size: 26982
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 2227175517da80ba886a0074154ed1b9
      size: 270
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: 2257bff05cc3b1fbb36f3a73ccb90b78
      size: 271
    - path: combined_plots.py
      hash: md5
      md5: caec96ccfbae3aaec2f390c7fd959e88
      size: 7151
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: ad80e3681729313ec97819530d1cdd42
      size: 269
    outs:
    - path: combined/acc.pdf
      hash: md5
      md5: 37fdbe264a3b8e614613b262d81530e1
      size: 34267
    - path: combined/cost.pdf
      hash: md5
      md5: 1a86f9967e23e37efb3d26f8c75c13cd
      size: 45578
    - path: combined/power.pdf
      hash: md5
      md5: f12c54cd9910c8fbce4bb88df20272e5
      size: 44335
    - path: combined/time.pdf
      hash: md5
      md5: 225f6dab8cde97a6dab310da0baee421
      size: 45499
    - path: data/combined/combined.csv
      hash: md5
      md5: d22720f16c4bc98dc65808923b99c642
      size: 52360413
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/combined/combined.csv
      hash: md5
      md5: d22720f16c4bc98dc65808923b99c642
      size: 52360413
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: combined/clean.csv
      hash: md5
      md5: 9c8adccd19445c4a933a3b3d8892ff2e
      size: 37144640
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 589c50684ec03d7a423a6668943b8540
      size: 7989
    - path: combined/clean.csv
      hash: md5
      md5: 9c8adccd19445c4a933a3b3d8892ff2e
      size: 37144640
    outs:
    - path: combined/aft_comparison.csv
      hash: md5
      md5: 3a0019b14a09be37adbd259de9dbad16
      size: 247
    - path: combined/aft_comparison.tex
      hash: md5
      md5: feb86ff3f9329c0b3b7c058ef7302a14
      size: 491
    - path: combined/log_logistic_aft.pdf
      hash: md5
      md5: c9db22681bf3745778ea843d719721b0
      size: 33880
    - path: combined/log_logistic_attack_eps_partial_effect.pdf
      hash: md5
      md5: cdb0049ea99584d23c278dd8592bd989
      size: 27181
    - path: combined/log_logistic_batch_size_partial_effect.pdf
      hash: md5
      md5: 65e6391d402d097451047377b90adbeb
      size: 29102
    - path: combined/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 8b25821be8ab1238fd0df4e3ffc04c9d
      size: 29857
    - path: combined/log_logistic_qq.pdf
      hash: md5
      md5: 1cb4bc801e30781159a6257ae6fc85b1
      size: 80192
    - path: combined/log_logistic_summary.csv
      hash: md5
      md5: 6989c7b4f0a7c8ca3a7439e741102ca2
      size: 1632
    - path: combined/log_logistic_summary.pdf
      hash: md5
      md5: 3dc8c0d448bc0e36c74c1a1f5cbc7bd5
      size: 35524
    - path: combined/log_normal_aft.pdf
      hash: md5
      md5: c760153142ede9a15425be58b880a684
      size: 35466
    - path: combined/log_normal_attack_eps_partial_effect.pdf
      hash: md5
      md5: 82274edbc7615827300fda871dccaf1e
      size: 27961
    - path: combined/log_normal_batch_size_partial_effect.pdf
      hash: md5
      md5: e5b704ae750e4eb6a953605a8281725b
      size: 29838
    - path: combined/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: aa0d6c3febb789ca68641151b3133032
      size: 29034
    - path: combined/log_normal_qq.pdf
      hash: md5
      md5: 31c7e37d8cb51050080abfb5cd291882
      size: 80638
    - path: combined/log_normal_summary.csv
      hash: md5
      md5: f0744e8379bac0a0216e96901095f342
      size: 3113
    - path: combined/log_normal_summary.pdf
      hash: md5
      md5: b5466fe064ffa39f6159f120bf792484
      size: 35189
    - path: combined/weibull_aft.pdf
      hash: md5
      md5: 7880981ca4a8b19e06604751251a2968
      size: 33784
    - path: combined/weibull_attack_eps_partial_effect.pdf
      hash: md5
      md5: a6cad8a16922d9bbb052be3196d70b03
      size: 26877
    - path: combined/weibull_batch_size_partial_effect.pdf
      hash: md5
      md5: 5d08cea34b926292ffce4db22c080eb2
      size: 29041
    - path: combined/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 4d01fcfc26dc51be5880e69ccc8b9358
      size: 28314
    - path: combined/weibull_qq.pdf
      hash: md5
      md5: 6dea1bd31c5d640dd116f82e667f24da
      size: 79726
    - path: combined/weibull_summary.csv
      hash: md5
      md5: 546350a82b4ec0551907bfff1ef2a0b3
      size: 2811
    - path: combined/weibull_summary.pdf
      hash: md5
      md5: 50e1bd836cf02de0b737b7d172f93d8e
      size: 35567
  copy@mnist:
    cmd: rm -rf ~/kepler-ml/plots/mnist/ && mkdir -p ~/kepler-ml/plots/mnist/ && cp
      -r mnist/* ~/kepler-ml/plots/mnist/
    deps:
    - path: mnist/
      hash: md5
      md5: 0bb4ea08e80e765597832dc64485e118.dir
      size: 25194927
      nfiles: 23
  copy@cifar:
    cmd: rm -rf ~/kepler-ml/plots/cifar/ && mkdir -p ~/kepler-ml/plots/cifar/ && cp
      -r cifar/* ~/kepler-ml/plots/cifar/
    deps:
    - path: cifar/
      hash: md5
      md5: d10b2f2706a58f75667b4ac487b1c8a1.dir
      size: 25102765
      nfiles: 23
  copy@cifar100:
    cmd: rm -rf ~/kepler-ml/plots/cifar100/ && mkdir -p ~/kepler-ml/plots/cifar100/
      && cp -r cifar100/* ~/kepler-ml/plots/cifar100/
    deps:
    - path: cifar100/
      hash: md5
      md5: 836fbb072b87eba8ee7a4ab66aa0ef15.dir
      size: 29910294
      nfiles: 23
  copy@combined:
    cmd: rm -rf ~/kepler-ml/plots/combined/ && mkdir -p ~/kepler-ml/plots/combined/
      && cp -r combined/* ~/kepler-ml/plots/combined/
    deps:
    - path: combined/
      hash: md5
      md5: 3cd1bd6ec5475c44d40a394599d0f823.dir
      size: 38119666
      nfiles: 32
