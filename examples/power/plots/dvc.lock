schema: '2.0'
stages:
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder plots/cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 538
    - path: data/bit_depth/cifar/power.csv
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5292031
    - path: data/cifar/power.csv
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9999301
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/cifar/merged.csv
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15307632
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i plots/cifar/merged.csv --o plots/cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 538
    - path: plots/cifar/merged.csv
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15307632
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/cifar/clean.csv
      md5: b0136f4fcc5b07b4560f7b53dcd0d89e
      size: 4727752
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder plots/mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 538
    - path: data/bit_depth/mnist/power.csv
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5422584
    - path: data/mnist/power.csv
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9970090
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/mnist/merged.csv
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15411588
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i plots/mnist/merged.csv --o plots/mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 538
    - path: plots/mnist/merged.csv
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15411588
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/mnist/clean.csv
      md5: fbb88e3d40c7e42cb636569e5eee6557
      size: 4852795
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder plots/cifar100/
      --output_file merged.csv
    deps:
    - path: ../conf/clean.yaml
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 538
    - path: data/bit_depth/cifar100/power.csv
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3988195
    - path: data/cifar100/power.csv
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16085014
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: plots/cifar100/merged.csv
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20103676
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i plots/cifar100/merged.csv --o plots/cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 538
    - path: plots/cifar100/merged.csv
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20103676
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/cifar100/clean.csv
      md5: 5463110b031067195ee6204dca9c9ea2
      size: 3564572
  plot@cifar100:
    cmd: python -m deckard.layers.plots --path plots/cifar100 --file plots/cifar100/clean.csv  -c
      "../conf/plots.yaml"
    deps:
    - path: ../conf/plots.yaml
      md5: 41c4bfd9ec8e4015e1afd1cc9776bd1f
      size: 1474
    - path: plots/cifar100/clean.csv
      md5: 5463110b031067195ee6204dca9c9ea2
      size: 3564572
    outs:
    - path: plots/cifar100/train_time_vs_accuracy.pdf
      md5: cc1786f3fd5047cedc08b219aaedba6d
      size: 20816
  plot@cifar:
    cmd: python -m deckard.layers.plots --path plots/cifar --file plots/cifar/clean.csv  -c
      "../conf/plots.yaml"
    deps:
    - path: ../conf/plots.yaml
      md5: 41c4bfd9ec8e4015e1afd1cc9776bd1f
      size: 1474
    - path: plots/cifar/clean.csv
      md5: b0136f4fcc5b07b4560f7b53dcd0d89e
      size: 4727752
    outs:
    - path: plots/cifar/train_time_vs_accuracy.pdf
      md5: 4294e8c195e485043b79c622fe2ac473
      size: 20816
  plot@mnist:
    cmd: python -m deckard.layers.plots --path plots/mnist --file plots/mnist/clean.csv  -c
      "../conf/plots.yaml"
    deps:
    - path: ../conf/plots.yaml
      md5: 41c4bfd9ec8e4015e1afd1cc9776bd1f
      size: 1474
    - path: plots/mnist/clean.csv
      md5: fbb88e3d40c7e42cb636569e5eee6557
      size: 4852795
    outs:
    - path: plots/mnist/train_time_vs_accuracy.pdf
      md5: afdc3ad3270c59c4d9d10378f0178b95
      size: 20816
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file plots/cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      md5: 2a4086df8d0d7b2bca644b414bc6ae8e
      size: 4835
    - path: plots/cifar/clean.csv
      md5: b0136f4fcc5b07b4560f7b53dcd0d89e
      size: 4727752
    outs:
    - path: plots/cifar/aft_comparison.csv
      md5: 7950e59308e428ff7031ed2804a78cf5
      size: 439
    - path: plots/cifar/aft_comparison.tex
      md5: b59e59cd800b31ea6dc78380bb5165aa
      size: 625
    - path: plots/cifar/cox_aft.pdf
      md5: 72a809a013ee5ebe4f7f992c369b02d0
      size: 20155
    - path: plots/cifar/cox_epochs_partial_effect.pdf
      md5: 738ecb321af99e5c734fa2ddae3bec9e
      size: 31782
    - path: plots/cifar/log_logistic_aft.pdf
      md5: 46360963348d3c6719e41f834664e3cf
      size: 23386
    - path: plots/cifar/log_logistic_epochs_partial_effect.pdf
      md5: 9b3db7e87debdf1a5c3fddf6ded6ca58
      size: 28396
    - path: plots/cifar/log_normal_aft.pdf
      md5: 712e8a12c8413bf945b1abe6dd5ad48b
      size: 24101
    - path: plots/cifar/log_normal_epochs_partial_effect.pdf
      md5: ba7c6c3c369308e1977ea28ec2d55b87
      size: 29094
    - path: plots/cifar/weibull_aft.pdf
      md5: 3054d3de12b58da9299194d1e23d06ba
      size: 30559
    - path: plots/cifar/weibull_epochs_partial_effect.pdf
      md5: cf37649e3e600b56437e3c5059b811a9
      size: 27876
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file plots/mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      md5: 2a4086df8d0d7b2bca644b414bc6ae8e
      size: 4835
    - path: plots/mnist/clean.csv
      md5: fbb88e3d40c7e42cb636569e5eee6557
      size: 4852795
    outs:
    - path: plots/mnist/aft_comparison.csv
      md5: f4ec28af783100aa553c2bf243edb0d4
      size: 452
    - path: plots/mnist/aft_comparison.tex
      md5: 1c862863d21161a3992d7d158e08ff2b
      size: 625
    - path: plots/mnist/cox_aft.pdf
      md5: 44680548d98b133e53628aa311f04a3f
      size: 20172
    - path: plots/mnist/cox_epochs_partial_effect.pdf
      md5: 591b1e11610d80cf69d956410b574caa
      size: 31086
    - path: plots/mnist/log_logistic_aft.pdf
      md5: 5a59a395e1d5170a5f48988fa5c4030e
      size: 23411
    - path: plots/mnist/log_logistic_epochs_partial_effect.pdf
      md5: cb9f315e98f44ec0aff7a10e39323d76
      size: 27616
    - path: plots/mnist/log_normal_aft.pdf
      md5: fba4ba8bf1f86e9552e5dc3b097161e3
      size: 24494
    - path: plots/mnist/log_normal_epochs_partial_effect.pdf
      md5: 4c6e813076777ebd94e1d9e733d181f8
      size: 28469
    - path: plots/mnist/weibull_aft.pdf
      md5: e1d7522fd89f5414791bb466ad72cf4a
      size: 30565
    - path: plots/mnist/weibull_epochs_partial_effect.pdf
      md5: 3fb7051fd1afed830d323fc46e8781ed
      size: 27669
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file plots/cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder plots/cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      md5: 2a4086df8d0d7b2bca644b414bc6ae8e
      size: 4835
    - path: plots/cifar100/clean.csv
      md5: 5463110b031067195ee6204dca9c9ea2
      size: 3564572
    outs:
    - path: plots/cifar100/aft_comparison.csv
      md5: fcb1ca6cb30856e0d22a552237e7df4d
      size: 443
    - path: plots/cifar100/aft_comparison.tex
      md5: ea9c99512718be5e33bb98959c2daddc
      size: 631
    - path: plots/cifar100/cox_aft.pdf
      md5: 17faca9aba0a0947a3101302bd96ab91
      size: 20579
    - path: plots/cifar100/cox_epochs_partial_effect.pdf
      md5: 861fe1022ad75867e2cbdc3735413587
      size: 30379
    - path: plots/cifar100/log_logistic_aft.pdf
      md5: addd75931d35e990c0403bafcc4929e5
      size: 23384
    - path: plots/cifar100/log_logistic_epochs_partial_effect.pdf
      md5: efab06e319fb5c1745833b159a44db5a
      size: 27709
    - path: plots/cifar100/log_normal_aft.pdf
      md5: e5228c720236769d5538d014516a71b1
      size: 24478
    - path: plots/cifar100/log_normal_epochs_partial_effect.pdf
      md5: 7625b0ee45b132133d706b2bba89f294
      size: 28530
    - path: plots/cifar100/weibull_aft.pdf
      md5: a600863e6f52b9eaf2596cd6b5617685
      size: 30545
    - path: plots/cifar100/weibull_epochs_partial_effect.pdf
      md5: 38ca53782b756d84329530fe3bbd1e9b
      size: 27405
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: combined_plots.py
      md5: 34b11809e278aa2f5ba2755004868c0f
      size: 7462
    - path: plots/cifar/aft_comparison.csv
      md5: 7950e59308e428ff7031ed2804a78cf5
      size: 439
    - path: plots/cifar100/aft_comparison.csv
      md5: fcb1ca6cb30856e0d22a552237e7df4d
      size: 443
    - path: plots/mnist/aft_comparison.csv
      md5: f4ec28af783100aa553c2bf243edb0d4
      size: 452
    outs:
    - path: data/combined/combined.csv
      md5: 493c48e49102ccf2dcc55e6513c2d617
      size: 52364568
    - path: plots/combined/acc.pdf
      md5: 43cd5f213e9b7516a8491141c3e754e3
      size: 26727
    - path: plots/combined/cost.pdf
      md5: 55f5c7676ad1e743d4e6519be232036c
      size: 38297
    - path: plots/combined/power.pdf
      md5: e903f99ffa769c0221f7175f6dde498f
      size: 38120
    - path: plots/combined/time.pdf
      md5: 8a9689d2bd20254390111419a4968866
      size: 36812
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o plots/combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 538
    - path: data/combined/combined.csv
      md5: 493c48e49102ccf2dcc55e6513c2d617
      size: 52364568
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: plots/combined/clean.csv
      md5: 65e04fe33bd6a5a4607236b0a48340c7
      size: 13643214
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file plots/combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder plots/combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      md5: 31773a5a32d187f3724ec42fbc7297bc
      size: 11230
    - path: plots/combined/clean.csv
      md5: 65e04fe33bd6a5a4607236b0a48340c7
      size: 13643214
    outs:
    - path: plots/combined/aft_comparison.csv
      md5: 1e241c985042cf93162f4a0b1af5a394
      size: 457
    - path: plots/combined/aft_comparison.tex
      md5: baa596b233d833b18f4b2166ea3126b1
      size: 681
    - path: plots/combined/cox_aft.pdf
      md5: c5a900607bb109ae2cbc4fea146bba53
      size: 20508
    - path: plots/combined/cox_attack_eps_partial_effect.pdf
      md5: ba21934cf752e2695a3fe9d29365148f
      size: 35870
    - path: plots/combined/cox_batch_size_partial_effect.pdf
      md5: a5fe17c53e98d548c2c64af7b5545ce6
      size: 39753
    - path: plots/combined/cox_epochs_partial_effect.pdf
      md5: 714226b0422dbbf44e7981a308d9ad25
      size: 38444
    - path: plots/combined/cox_predict_time_partial_effect.pdf
      md5: be307cbc4b225229e4a5d9f053cdf7af
      size: 35521
    - path: plots/combined/cox_train_time_partial_effect.pdf
      md5: 74196b2cf8163e142212361cd71a9d1a
      size: 36019
    - path: plots/combined/log_logistic_aft.pdf
      md5: 488e0758e13b20a5ae52b747a33281fb
      size: 23098
    - path: plots/combined/log_logistic_attack_eps_partial_effect.pdf
      md5: c133ed94b95a2c76b914b793191cee9e
      size: 27222
    - path: plots/combined/log_logistic_batch_size_partial_effect.pdf
      md5: 6fea5bb6a8840eedf9b1b538c6da00a5
      size: 28850
    - path: plots/combined/log_logistic_epochs_partial_effect.pdf
      md5: 87bcb10d6a362f4820ef22b3d4a9fa85
      size: 28294
    - path: plots/combined/log_logistic_predict_time_partial_effect.pdf
      md5: d4597dcaf768c6ea07c7d46f0f7d5efc
      size: 26897
    - path: plots/combined/log_logistic_train_time_partial_effect.pdf
      md5: a655314bb9bef73c6e43326e4515a004
      size: 24888
    - path: plots/combined/log_normal_aft.pdf
      md5: 4a8ad3860f22cad4234d2a79715fac51
      size: 24385
    - path: plots/combined/log_normal_attack_eps_partial_effect.pdf
      md5: ae12dbec6db899920cf2bc753cb291d7
      size: 27903
    - path: plots/combined/log_normal_batch_size_partial_effect.pdf
      md5: b247a9c6b54ce6f3fc5274a214d2c97a
      size: 29896
    - path: plots/combined/log_normal_epochs_partial_effect.pdf
      md5: c0c03739b42600368f091f4109f62af1
      size: 29043
    - path: plots/combined/log_normal_predict_time_partial_effect.pdf
      md5: 95465d14d72f9777e4a61276f94dede2
      size: 27579
    - path: plots/combined/log_normal_train_time_partial_effect.pdf
      md5: 0eec0df914fc54e4127c45ba9d47fe64
      size: 25957
    - path: plots/combined/weibull_aft.pdf
      md5: 46b012ea514cfff0b3ffdfeb1695fb23
      size: 30531
    - path: plots/combined/weibull_attack_eps_partial_effect.pdf
      md5: a564679c64373fd98582f466e25c24ae
      size: 26911
    - path: plots/combined/weibull_batch_size_partial_effect.pdf
      md5: 5cfd01e9aedb305bcd741a98859d004b
      size: 28878
    - path: plots/combined/weibull_epochs_partial_effect.pdf
      md5: 5fca1ed40c8e186b891b9e82f10f05eb
      size: 28146
    - path: plots/combined/weibull_predict_time_partial_effect.pdf
      md5: 07722a8351eb7f45c0883b3babaee185
      size: 26592
    - path: plots/combined/weibull_train_time_partial_effect.pdf
      md5: 2a635c6aacfa4e6fa3b4df60e07d3a27
      size: 24866
