schema: '2.0'
stages:
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder cifar100/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar100/power.csv
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3987447
    - path: data/cifar100/power.csv
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16081846
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i cifar100/merged.csv --o cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
    outs:
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: 280772a94f143514d6ea1696a2c2c74a
      size: 273
    - path: cifar100/aft_comparison.tex
      hash: md5
      md5: 5ff7646519a213c95ba4ad3436c8c266
      size: 532
    - path: cifar100/cox_aft.pdf
      hash: md5
      md5: 3c104bd9af4303a21717c02f8eaae49f
      size: 32152
    - path: cifar100/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 47bde46ccf42cb64aabbc1a139fd504f
      size: 33262
    - path: cifar100/log_logistic_aft.pdf
      hash: md5
      md5: 9a6ef3ee70326e9968f43e182c348094
      size: 34138
    - path: cifar100/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 7e010cb7d8ef1650c306d40cf71d49c6
      size: 27108
    - path: cifar100/log_normal_aft.pdf
      hash: md5
      md5: 5b86783b69dd93c4cca5668ebbae8ab7
      size: 36607
    - path: cifar100/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 241f6518c1c310707d93af4efe8255ad
      size: 27996
    - path: cifar100/weibull_aft.pdf
      hash: md5
      md5: f1c81a612c5e9cf42cd8f2aad5be707a
      size: 34233
    - path: cifar100/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 41275cf0fe5f4730fd3c2b0fba05b12b
      size: 27984
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar/power.csv
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5291011
    - path: data/cifar/power.csv
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9997291
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/mnist/power.csv
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5421537
    - path: data/mnist/power.csv
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9968081
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i mnist/merged.csv --o mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
    outs:
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: d3d0f4847997af360c395cbddf932817
      size: 271
    - path: mnist/aft_comparison.tex
      hash: md5
      md5: 28195614dc318613d264979f2fc8065f
      size: 526
    - path: mnist/cox_aft.pdf
      hash: md5
      md5: dfe3258b6578e617ec7570c8a6dc8e1a
      size: 31798
    - path: mnist/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 9122ee9c779cdc47001b750ac7b08c62
      size: 32663
    - path: mnist/log_logistic_aft.pdf
      hash: md5
      md5: f17b3d7ac8121eed0c054d0a3808ea0f
      size: 34388
    - path: mnist/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: a42268c693842c88649b96068c22ee3c
      size: 27213
    - path: mnist/log_normal_aft.pdf
      hash: md5
      md5: 90ded9c764f4b080439eab95cf1c347e
      size: 36004
    - path: mnist/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: f9e417a84848bd8cfeb2a32e68bc0c06
      size: 28114
    - path: mnist/weibull_aft.pdf
      hash: md5
      md5: c40f9d596d1ef8de073deb7a158d5ae5
      size: 33870
    - path: mnist/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: e154e67b11572ef95b0c6d6bf5e0ed1e
      size: 26912
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i cifar/merged.csv --o cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
    outs:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 22b9e9207595fa1773dede9a6cbe4046
      size: 272
    - path: cifar/aft_comparison.tex
      hash: md5
      md5: 96ac6d26a82de872a65cf26ca51835d8
      size: 526
    - path: cifar/cox_aft.pdf
      hash: md5
      md5: a01ce557d1947addb017c95635126cbc
      size: 32165
    - path: cifar/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 859bd3d0c416a3fbc355a0f4b34d7c48
      size: 33196
    - path: cifar/log_logistic_aft.pdf
      hash: md5
      md5: f7a084c6f00605b4ed220dcec15acc2b
      size: 34161
    - path: cifar/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: ddba862862cffa027d77779f4589cb38
      size: 27406
    - path: cifar/log_normal_aft.pdf
      hash: md5
      md5: 1018610a9e8639a91bffeb006e45c9d8
      size: 36603
    - path: cifar/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 131f2fe63a1aa0c04d597382ca593d28
      size: 28108
    - path: cifar/weibull_aft.pdf
      hash: md5
      md5: 59d50a5cdd838228f91b7be917bc1660
      size: 33881
    - path: cifar/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 8e33d5fe506a42ea5f42825876634a60
      size: 26982
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 22b9e9207595fa1773dede9a6cbe4046
      size: 272
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: 280772a94f143514d6ea1696a2c2c74a
      size: 273
    - path: combined_plots.py
      hash: md5
      md5: caec96ccfbae3aaec2f390c7fd959e88
      size: 7151
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: d3d0f4847997af360c395cbddf932817
      size: 271
    outs:
    - path: combined/acc.pdf
      hash: md5
      md5: cfc4bb75d5f35913356888b33a2bdd0c
      size: 34267
    - path: combined/cost.pdf
      hash: md5
      md5: 7c66b8a1c0d40f8b19904018cbfea049
      size: 45578
    - path: combined/power.pdf
      hash: md5
      md5: 9cc9f4c3addbe087c75c188b9c9fc65c
      size: 44335
    - path: combined/time.pdf
      hash: md5
      md5: 19c62fc845518c044370accc0cd336eb
      size: 45499
    - path: data/combined/combined.csv
      hash: md5
      md5: d22720f16c4bc98dc65808923b99c642
      size: 52360413
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/combined/combined.csv
      hash: md5
      md5: d22720f16c4bc98dc65808923b99c642
      size: 52360413
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: combined/clean.csv
      hash: md5
      md5: 9c8adccd19445c4a933a3b3d8892ff2e
      size: 37144640
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 807b567bfda8e65d9c202c06d6d5c3a0
      size: 7962
    - path: combined/clean.csv
      hash: md5
      md5: 9c8adccd19445c4a933a3b3d8892ff2e
      size: 37144640
    outs:
    - path: combined/aft_comparison.csv
      hash: md5
      md5: 3a0019b14a09be37adbd259de9dbad16
      size: 247
    - path: combined/aft_comparison.tex
      hash: md5
      md5: feb86ff3f9329c0b3b7c058ef7302a14
      size: 491
    - path: combined/log_logistic_aft.pdf
      hash: md5
      md5: fe627187be3486135673151399e77da5
      size: 33880
    - path: combined/log_logistic_attack_eps_partial_effect.pdf
      hash: md5
      md5: a15067a2996700a2bf8e5da9966ef5ac
      size: 27181
    - path: combined/log_logistic_batch_size_partial_effect.pdf
      hash: md5
      md5: 3354532cd39845663b5fd84b9dfcfb0c
      size: 29102
    - path: combined/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 5e2b90631e13bc0c6555fb7e454a6f40
      size: 28298
    - path: combined/log_logistic_qq.pdf
      hash: md5
      md5: 9c16f461f84911d70c0391bf550a341c
      size: 80192
    - path: combined/log_logistic_summary.csv
      hash: md5
      md5: 6989c7b4f0a7c8ca3a7439e741102ca2
      size: 1632
    - path: combined/log_logistic_summary.pdf
      hash: md5
      md5: 15ba7216765f70e5c3e39ee5b14f05c2
      size: 35673
    - path: combined/log_normal_aft.pdf
      hash: md5
      md5: 5646c562f12c4778c7f71b84cd5aa285
      size: 35466
    - path: combined/log_normal_attack_eps_partial_effect.pdf
      hash: md5
      md5: 6808747b8c495208849c58ac86b3978d
      size: 27961
    - path: combined/log_normal_batch_size_partial_effect.pdf
      hash: md5
      md5: 30c4671d2f5006c07af5ada118cffbb9
      size: 29838
    - path: combined/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 591b2133347fd1d085ea26e8639c94a3
      size: 29034
    - path: combined/log_normal_qq.pdf
      hash: md5
      md5: e12b06ea999b099c2149079afb1a818e
      size: 80638
    - path: combined/log_normal_summary.csv
      hash: md5
      md5: f0744e8379bac0a0216e96901095f342
      size: 3113
    - path: combined/log_normal_summary.pdf
      hash: md5
      md5: 703747a43f7746593f37db8291a895dd
      size: 35338
    - path: combined/weibull_aft.pdf
      hash: md5
      md5: bc4b7f9e85a0c882c6a47dbf7ad64e36
      size: 33784
    - path: combined/weibull_attack_eps_partial_effect.pdf
      hash: md5
      md5: 3228a951f8d2ef1f8f18fdda0d0d1c74
      size: 26877
    - path: combined/weibull_batch_size_partial_effect.pdf
      hash: md5
      md5: 6a8ef49777ffa7366277940394efa386
      size: 29041
    - path: combined/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 804622ba276bb304d0de82d2aa693086
      size: 28314
    - path: combined/weibull_qq.pdf
      hash: md5
      md5: 2163f604f06f868b550e367f5eaee64a
      size: 79726
    - path: combined/weibull_summary.csv
      hash: md5
      md5: 546350a82b4ec0551907bfff1ef2a0b3
      size: 2811
    - path: combined/weibull_summary.pdf
      hash: md5
      md5: 4172420e90d09176f8c575ca3eeb61d5
      size: 35721
  copy@mnist:
    cmd: rm -rf ~/kepler-ml/data/mnist && mkdir -p ~/kepler-ml/data/mnist/ && cp -r
      mnist/* ~/kepler_ml/data/
    deps:
    - path: mnist/
      hash: md5
      md5: 0383c876b455cc3e97abc107a6b73226.dir
      size: 25197079
      nfiles: 23
  copy@cifar:
    cmd: rm -rf ~/kepler-ml/data/cifar && mkdir -p ~/kepler-ml/data/cifar/ && cp -r
      cifar/* ~/kepler_ml/data/
    deps:
    - path: cifar/
      hash: md5
      md5: 92978768208edd65158edad814b098ff.dir
      size: 25104943
      nfiles: 23
  copy@cifar100:
    cmd: rm -rf ~/kepler-ml/data/cifar100 && mkdir -p ~/kepler-ml/data/cifar100/ &&
      cp -r cifar100/* ~/kepler_ml/data/
    deps:
    - path: cifar100/
      hash: md5
      md5: 293eaa0ca9614af1293bab5d15e1104c.dir
      size: 29912336
      nfiles: 23
  copy@combined:
    cmd: rm -rf ~/kepler-ml/data/combined && mkdir -p ~/kepler-ml/data/combined/ &&
      cp -r combined/* ~/kepler_ml/data/
    deps:
    - path: combined/
      hash: md5
      md5: 3ad4ee1609bd56cebe491e782410c91c.dir
      size: 38118559
      nfiles: 32
