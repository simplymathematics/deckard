schema: '2.0'
stages:
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder cifar100/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar100/power.csv
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3987447
    - path: data/cifar100/power.csv
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16081846
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i cifar100/merged.csv --o cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
    outs:
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: b7c15ae615a33408a0b727601cab890a
      size: 212
    - path: cifar100/aft_comparison.tex
      hash: md5
      md5: cdb0ed40fb89a414c227e468df78816a
      size: 486
    - path: cifar100/cox_aft.pdf
      hash: md5
      md5: cbf75d3444dfa85d8473c1adca76cc90
      size: 28926
    - path: cifar100/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 5ef1f01e00885006836330c1cd571902
      size: 33262
    - path: cifar100/log_logistic_aft.pdf
      hash: md5
      md5: 1d7a0ffc37581ea9fdf261eaf6fcbe13
      size: 29307
    - path: cifar100/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 56457fa49b615f1b310164685d974764
      size: 27155
    - path: cifar100/log_normal_aft.pdf
      hash: md5
      md5: 2df7406e968c1a40f08180b4cca67800
      size: 29841
    - path: cifar100/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 8d9d5c56283611e8ead5e569ed705dea
      size: 27993
    - path: cifar100/weibull_aft.pdf
      hash: md5
      md5: 37fa477caef7548d8d84cc2c962aa1e1
      size: 29018
    - path: cifar100/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: bac81f07ad7d2222a56b6692d1dc4b9f
      size: 28027
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar/power.csv
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5291011
    - path: data/cifar/power.csv
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9997291
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/mnist/power.csv
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5421537
    - path: data/mnist/power.csv
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9968081
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i mnist/merged.csv --o mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
    outs:
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: 83bac6dcedac880fa889c4eb997ef11b
      size: 207
    - path: mnist/aft_comparison.tex
      hash: md5
      md5: d30dffbc8bce9f9634951a6dd64b816e
      size: 480
    - path: mnist/cox_aft.pdf
      hash: md5
      md5: 744bd8d59c70aa835e6e25a73f219ff8
      size: 28581
    - path: mnist/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 8369f51b146b86a41e73fe10ba7d4b32
      size: 32663
    - path: mnist/log_logistic_aft.pdf
      hash: md5
      md5: 332b45ddd9106db2543a895d52f9afba
      size: 29342
    - path: mnist/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 154cd923eee7b9956c8615fac8f30c7f
      size: 27325
    - path: mnist/log_normal_aft.pdf
      hash: md5
      md5: caa3e255cb514b768761978bed534cde
      size: 29874
    - path: mnist/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 46fc77fd1f0283c1f3f1efdc5576d99d
      size: 28077
    - path: mnist/weibull_aft.pdf
      hash: md5
      md5: 45302e29c47d66b4253dd0b4d19ec6b6
      size: 29062
    - path: mnist/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: d395f4b0c5b684a3ca02a523ba5e5b8d
      size: 26910
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i cifar/merged.csv --o cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
    outs:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 42dad9a57c0b74eee3caffbd85e177d0
      size: 211
    - path: cifar/aft_comparison.tex
      hash: md5
      md5: 7714e372f69ad7ecc7e6fda60ade049d
      size: 480
    - path: cifar/cox_aft.pdf
      hash: md5
      md5: 8a35a0828be63e1af021369435a8f86c
      size: 28935
    - path: cifar/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 45275150fcc16bbf1585290a87d106cf
      size: 33196
    - path: cifar/log_logistic_aft.pdf
      hash: md5
      md5: 04c32421703bd12c6eeeff36aeee948d
      size: 29703
    - path: cifar/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 5a38ce4c210194d42e14db1f07ee4185
      size: 27433
    - path: cifar/log_normal_aft.pdf
      hash: md5
      md5: b740f9f20a9bf4343176d7ae9e08f203
      size: 30232
    - path: cifar/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 136be43a5fd7aafbcf6cacf1a1f323ea
      size: 28162
    - path: cifar/weibull_aft.pdf
      hash: md5
      md5: af998a868f289717688a951efe7f5b17
      size: 28724
    - path: cifar/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 26f2bf273cd30276a25f7b297a4f6b8b
      size: 28030
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 42dad9a57c0b74eee3caffbd85e177d0
      size: 211
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: b7c15ae615a33408a0b727601cab890a
      size: 212
    - path: combined_plots.py
      hash: md5
      md5: e7c5bcaa887f2e80a4a95370c717292b
      size: 7724
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: 83bac6dcedac880fa889c4eb997ef11b
      size: 207
    outs:
    - path: combined/acc.pdf
      hash: md5
      md5: 7c28f43fde25255d81a379dcf54f132a
      size: 30390
    - path: combined/cost.pdf
      hash: md5
      md5: ac14ee6842bede1a6eccc0661607066f
      size: 39900
    - path: combined/power.pdf
      hash: md5
      md5: a2dfe93e6448bfc157837339813ffdc7
      size: 40090
    - path: combined/time.pdf
      hash: md5
      md5: b97a0cbd011598f2d6af3e6b32f669bc
      size: 40222
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: combined/clean.csv
      hash: md5
      md5: 24f49787a6d20f9172dacf9edefff85f
      size: 37298176
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 068c842adac014ff65cbf74d28e57263
      size: 8923
    - path: combined/clean.csv
      hash: md5
      md5: 24f49787a6d20f9172dacf9edefff85f
      size: 37298176
    outs:
    - path: combined/aft_comparison.csv
      hash: md5
      md5: 238ff959f5768d165bddb38595db5d37
      size: 188
    - path: combined/aft_comparison.tex
      hash: md5
      md5: eb58f6f50165198332bdce8c44afb298
      size: 441
    - path: combined/log_logistic_aft.pdf
      hash: md5
      md5: 0bf3070ad1414cabd4bcb80907258eee
      size: 26842
    - path: combined/log_logistic_attack_eps_partial_effect.pdf
      hash: md5
      md5: f3898e09d48f3a2af8987a71aff1b277
      size: 26868
    - path: combined/log_logistic_batch_size_partial_effect.pdf
      hash: md5
      md5: cb233bc27cf455027e5bc0ad8e7db879
      size: 28790
    - path: combined/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 44e2c3369769dc7859d5b0036d30b499
      size: 27938
    - path: combined/log_logistic_qq.pdf
      hash: md5
      md5: 9fc112d3830606b0fd40e42e0d20931c
      size: 18398
    - path: combined/log_logistic_summary.csv
      hash: md5
      md5: c0cbc323a723516dbd3087bb9440caf1
      size: 3486
    - path: combined/log_logistic_summary.pdf
      hash: md5
      md5: 382c6ac53101c9c4924e475c5aea79a9
      size: 24177
    - path: combined/log_normal_aft.pdf
      hash: md5
      md5: 7b4a167101ec68944e9a66d1be42c87e
      size: 27359
    - path: combined/log_normal_attack_eps_partial_effect.pdf
      hash: md5
      md5: d56182d8d43de74b5d6a8622e3ccee9e
      size: 27579
    - path: combined/log_normal_batch_size_partial_effect.pdf
      hash: md5
      md5: 120bed4c45c410ab856ef88fee53c405
      size: 29598
    - path: combined/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 0117641629e52b8d4e9d5f4280820745
      size: 28603
    - path: combined/log_normal_qq.pdf
      hash: md5
      md5: b5798bc7b016d6fe81fb9f58bce6b058
      size: 19371
    - path: combined/log_normal_summary.csv
      hash: md5
      md5: 9025cfe2f47a1a1aa0d9fb3575072712
      size: 3445
    - path: combined/log_normal_summary.pdf
      hash: md5
      md5: 6c2d04b7321fad3849da1868ec739b8a
      size: 23588
    - path: combined/weibull_aft.pdf
      hash: md5
      md5: e5327964bc191bacbb7fd957dd04e2e7
      size: 26881
    - path: combined/weibull_attack_eps_partial_effect.pdf
      hash: md5
      md5: 6ec9a2d3861f93ea1d91010e184b1be7
      size: 26258
    - path: combined/weibull_batch_size_partial_effect.pdf
      hash: md5
      md5: 556f47492166aa543eef9b95ec96167f
      size: 28543
    - path: combined/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 1b2f8ee1a7a6883eb380f014a72a8bf7
      size: 27623
    - path: combined/weibull_qq.pdf
      hash: md5
      md5: f9dd4cc56777d0b137681c07354cf738
      size: 17754
    - path: combined/weibull_summary.csv
      hash: md5
      md5: 60e0589a5a15d42dff93363a7eb4321d
      size: 3496
    - path: combined/weibull_summary.pdf
      hash: md5
      md5: ae3bf2178757eb503effed5d39f74388
      size: 23246
  copy@mnist:
    cmd: rm -rf ~/kepler-ml/plots/mnist/ && mkdir -p ~/kepler-ml/plots/mnist/ && cp
      -r mnist/* ~/kepler-ml/plots/mnist/
    deps:
    - path: mnist/
      hash: md5
      md5: 07f01c161cb5670d301a39e8fe449588.dir
      size: 25117183
      nfiles: 24
  copy@cifar:
    cmd: rm -rf ~/kepler-ml/plots/cifar/ && mkdir -p ~/kepler-ml/plots/cifar/ && cp
      -r cifar/* ~/kepler-ml/plots/cifar/
    deps:
    - path: cifar/
      hash: md5
      md5: 6c9004b85a2f59cf28092e1808efd7a7.dir
      size: 25026430
      nfiles: 24
  copy@cifar100:
    cmd: rm -rf ~/kepler-ml/plots/cifar100/ && mkdir -p ~/kepler-ml/plots/cifar100/
      && cp -r cifar100/* ~/kepler-ml/plots/cifar100/
    deps:
    - path: cifar100/
      hash: md5
      md5: 048bc237237319818d83dc13b0ffd289.dir
      size: 29834329
      nfiles: 24
  copy@combined:
    cmd: rm -rf ~/kepler-ml/plots/combined/ && mkdir -p ~/kepler-ml/plots/combined/
      && cp -r combined/* ~/kepler-ml/plots/combined/
    deps:
    - path: combined/
      hash: md5
      md5: 91981ec9e39fb9404729910de3f9919c.dir
      size: 38101321
      nfiles: 35
