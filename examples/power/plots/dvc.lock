schema: '2.0'
stages:
  merge@cifar100:
    cmd: python merge.py  --big_dir data/bit_depth/cifar100 --little_dir data/cifar100
      --config ../conf/afr.yaml --data_file power.csv --output_folder cifar100/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar100/power.csv
      md5: d52080413e3ba7bd86ef8d92ebd00507
      size: 3987447
    - path: data/cifar100/power.csv
      md5: f51f0d4ebd105f64829af90a0212de00
      size: 16081846
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
  clean@cifar100:
    cmd: python -m deckard.layers.clean_data --i cifar100/merged.csv --o cifar100/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar100/merged.csv
      hash: md5
      md5: f2bf33451a3c6a27e8b37dafc2a30ace
      size: 20099761
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
  afr@cifar100:
    cmd: python -m deckard.layers.afr --dataset cifar100 --data_file cifar100/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar100/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar100/clean.csv
      hash: md5
      md5: 57d972137d581f726c30f609f6e3dc16
      size: 9316351
    outs:
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: b7c15ae615a33408a0b727601cab890a
      size: 212
    - path: cifar100/aft_comparison.tex
      hash: md5
      md5: 3466f7e3a4024d83bbaa2ccc7b13da80
      size: 472
    - path: cifar100/cox_aft.pdf
      hash: md5
      md5: fc12c932850ef41ba16df3de2e72d74b
      size: 28926
    - path: cifar100/cox_epochs_partial_effect.pdf
      hash: md5
      md5: ff12bf8887abfcd16935dcb3660130d6
      size: 33262
    - path: cifar100/log_logistic_aft.pdf
      hash: md5
      md5: 7c9a32b36620e829a14b83afa764cd84
      size: 29307
    - path: cifar100/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 748d1cfae5348ec21f5b8adc1f0be2ff
      size: 27155
    - path: cifar100/log_normal_aft.pdf
      hash: md5
      md5: 7bfdc421c9c972f3b6eb689a91215601
      size: 29841
    - path: cifar100/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: a9f96e86a01f8da297b9e9c829943636
      size: 27993
    - path: cifar100/weibull_aft.pdf
      hash: md5
      md5: 775cbb17a5438add77171cfd838a39aa
      size: 29018
    - path: cifar100/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 475c1295452cad56c47b2946278c5f48
      size: 28027
  merge@cifar:
    cmd: python merge.py  --big_dir data/bit_depth/cifar --little_dir data/cifar --config
      ../conf/afr.yaml --data_file power.csv --output_folder cifar/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/cifar/power.csv
      md5: b9ebbe01b2bd93f1c4af02fb8abd910b
      size: 5291011
    - path: data/cifar/power.csv
      md5: a8e056a8c4008ce37006237f2e44b2bf
      size: 9997291
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
  merge@mnist:
    cmd: python merge.py  --big_dir data/bit_depth/mnist --little_dir data/mnist --config
      ../conf/afr.yaml --data_file power.csv --output_folder mnist/ --output_file
      merged.csv
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/bit_depth/mnist/power.csv
      md5: ed40bca679961759527ca94ca4cbd984
      size: 5421537
    - path: data/mnist/power.csv
      md5: 6c84e8e91d81504e86db933bab0e9ae2
      size: 9968081
    params:
      ../conf/clean.yaml:
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
    outs:
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
  clean@mnist:
    cmd: python -m deckard.layers.clean_data --i mnist/merged.csv --o mnist/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: mnist/merged.csv
      hash: md5
      md5: 8f227012f75f50d6f01745b54d2dc5a5
      size: 15408533
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
  afr@mnist:
    cmd: python -m deckard.layers.afr --dataset mnist --data_file mnist/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder mnist/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: mnist/clean.csv
      hash: md5
      md5: 6d39faeafde4c9f3c7c1cca0f3dac5a8
      size: 9292855
    outs:
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: 83bac6dcedac880fa889c4eb997ef11b
      size: 207
    - path: mnist/aft_comparison.tex
      hash: md5
      md5: 030489512539372044c8f958ce6bab22
      size: 467
    - path: mnist/cox_aft.pdf
      hash: md5
      md5: badd88c48bedc5533c3688243a6b2ed7
      size: 28581
    - path: mnist/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 9daed5dab5390203831cd6d4e1f3fe4d
      size: 32663
    - path: mnist/log_logistic_aft.pdf
      hash: md5
      md5: a4d85b10c8d2d976d63564da2ed2a2e2
      size: 29342
    - path: mnist/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: e720b88a9e1b16926fd5e67c06041ffd
      size: 27325
    - path: mnist/log_normal_aft.pdf
      hash: md5
      md5: dca7262a9d812b992ad7c2d3c691d26d
      size: 29874
    - path: mnist/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: fdae7f75b38f81207567a43d02c56620
      size: 28077
    - path: mnist/weibull_aft.pdf
      hash: md5
      md5: ba52cbec37c40ae712317798a235be1c
      size: 29062
    - path: mnist/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: 587c9e5426271956bd3f7152e1e5d6d7
      size: 26910
  clean@cifar:
    cmd: python -m deckard.layers.clean_data --i cifar/merged.csv --o cifar/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: cifar/merged.csv
      hash: md5
      md5: 2d2cbcb913a61d304950c910bd487b9b
      size: 15304603
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
  afr@cifar:
    cmd: python -m deckard.layers.afr --dataset cifar --data_file cifar/clean.csv
      --config_file "../conf/afr.yaml" --plots_folder cifar/ --target adv_failures
      --duration_col adv_fit_time
    deps:
    - path: ../conf/afr.yaml
      hash: md5
      md5: 2d5b03f6b006b2fe0f875e47b4634e10
      size: 4793
    - path: cifar/clean.csv
      hash: md5
      md5: f11065790fb385b9ca6ab6a21bcb8ec2
      size: 9303640
    outs:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 42dad9a57c0b74eee3caffbd85e177d0
      size: 211
    - path: cifar/aft_comparison.tex
      hash: md5
      md5: 112fb42d06cc47aee03cf203865133bf
      size: 471
    - path: cifar/cox_aft.pdf
      hash: md5
      md5: 83212b959585a0ae0434b9b7cafb10e3
      size: 28935
    - path: cifar/cox_epochs_partial_effect.pdf
      hash: md5
      md5: 6185e86d8076f9e74493c59955a31072
      size: 33196
    - path: cifar/log_logistic_aft.pdf
      hash: md5
      md5: d59707b4bb90132bee47b89771bcaf36
      size: 29703
    - path: cifar/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 8564892a05df4514b8efa3e82465e738
      size: 27433
    - path: cifar/log_normal_aft.pdf
      hash: md5
      md5: 5b60b30be4439548d87b8b6b561a6d59
      size: 30232
    - path: cifar/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: a8b88931c4aac9a06596399df8e32db6
      size: 28162
    - path: cifar/weibull_aft.pdf
      hash: md5
      md5: f5d11bc085309d189fa063961c4269f9
      size: 28724
    - path: cifar/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: b03871005761865028d2ffe228e9f46e
      size: 28030
  combined_plots:
    cmd: python combined_plots.py
    deps:
    - path: cifar/aft_comparison.csv
      hash: md5
      md5: 42dad9a57c0b74eee3caffbd85e177d0
      size: 211
    - path: cifar100/aft_comparison.csv
      hash: md5
      md5: b7c15ae615a33408a0b727601cab890a
      size: 212
    - path: combined_plots.py
      hash: md5
      md5: 7ea9df483b87b41bbe1195b55275bd6c
      size: 7724
    - path: mnist/aft_comparison.csv
      hash: md5
      md5: 83bac6dcedac880fa889c4eb997ef11b
      size: 207
    outs:
    - path: combined/acc.pdf
      hash: md5
      md5: bfb5e9dba84ac202be126a8c621d23d9
      size: 30390
    - path: combined/cost.pdf
      hash: md5
      md5: 9df12549e3a4c092133df447e3b0623f
      size: 39900
    - path: combined/power.pdf
      hash: md5
      md5: 4e2daded7728626514ceec7a9815177c
      size: 40090
    - path: combined/time.pdf
      hash: md5
      md5: 0eb8142ce3e8f8e6764958b131809a72
      size: 40222
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
  combined_clean:
    cmd: python -m deckard.layers.clean_data --i data/combined/combined.csv --o combined/clean.csv
      --config "../conf/clean.yaml"
    deps:
    - path: ../conf/clean.yaml
      hash: md5
      md5: 3b23a3d656ad56e49e69f8624e227852
      size: 513
    - path: data/combined/combined.csv
      hash: md5
      md5: 5373a0cba09196ebf00bbfbab9378398
      size: 52639498
    params:
      ../conf/clean.yaml:
        attacks:
          FastGradientMethod: FGM
          ProjectedGradientDescent: PGD
          HopSkipJump: HSJ
          DeepFool: Deep
        defences:
          Control: Control
          FeatureSqueezing: FSQ
          Epochs: Epochs
          model_layers: Control
        fillna:
          Epochs: 20
          FGM: 0.0
          FSQ: 32
          Control: 18
          Batch_Size: 1024
        params:
          FGM: attack.init.eps
          PGD: attack.init.eps
          HSJ: attack.init.eps
          DeepFool: attack.init.eps
          FSQ: model.art.preprocessor.bit_depth
          Control: model_layers
          Epochs: model.trainer.nb_epoch
          Batch_Size: model.trainer.batch_size
    outs:
    - path: combined/clean.csv
      hash: md5
      md5: 24f49787a6d20f9172dacf9edefff85f
      size: 37298176
  combined_afr:
    cmd: python -m deckard.layers.afr --dataset Combined --data_file combined/clean.csv
      --config_file "../conf/combined_afr.yaml" --plots_folder combined/ --target
      adv_failures --duration_col adv_fit_time
    deps:
    - path: ../conf/combined_afr.yaml
      hash: md5
      md5: 068c842adac014ff65cbf74d28e57263
      size: 8923
    - path: combined/clean.csv
      hash: md5
      md5: 24f49787a6d20f9172dacf9edefff85f
      size: 37298176
    outs:
    - path: combined/aft_comparison.csv
      hash: md5
      md5: 238ff959f5768d165bddb38595db5d37
      size: 188
    - path: combined/aft_comparison.tex
      hash: md5
      md5: 14bc20405c6aadb2dfc4e421cd38ca10
      size: 435
    - path: combined/log_logistic_aft.pdf
      hash: md5
      md5: 8f4e80cd56876ccd92f24a73e9ab5285
      size: 26842
    - path: combined/log_logistic_attack_eps_partial_effect.pdf
      hash: md5
      md5: 8e9199d6630b67f7f75b5180fd12d865
      size: 26868
    - path: combined/log_logistic_batch_size_partial_effect.pdf
      hash: md5
      md5: b45e4c96a47972a0a22db436cec820a3
      size: 28790
    - path: combined/log_logistic_epochs_partial_effect.pdf
      hash: md5
      md5: 7bb19ab112fccb6262e5f269d331f9dc
      size: 27938
    - path: combined/log_logistic_qq.pdf
      hash: md5
      md5: a83dfd4d080d184d212f649a6d52e3b3
      size: 18763
    - path: combined/log_logistic_summary.csv
      hash: md5
      md5: c0cbc323a723516dbd3087bb9440caf1
      size: 3486
    - path: combined/log_logistic_summary.pdf
      hash: md5
      md5: 4237b428841e2a8238248d18755f3041
      size: 29010
    - path: combined/log_normal_aft.pdf
      hash: md5
      md5: 67b54435bb8e2df3588716cd82d0315d
      size: 27359
    - path: combined/log_normal_attack_eps_partial_effect.pdf
      hash: md5
      md5: 3f79348043dd09af41644d24168e8e08
      size: 27579
    - path: combined/log_normal_batch_size_partial_effect.pdf
      hash: md5
      md5: b8d9ff7e5c869b5ffad583ac4e145da4
      size: 29598
    - path: combined/log_normal_epochs_partial_effect.pdf
      hash: md5
      md5: 4419a7291480cfa3781102182bef3b8b
      size: 28603
    - path: combined/log_normal_qq.pdf
      hash: md5
      md5: ac00dd3683143d9b05c3a9db2e2989bd
      size: 19906
    - path: combined/log_normal_summary.csv
      hash: md5
      md5: 9025cfe2f47a1a1aa0d9fb3575072712
      size: 3445
    - path: combined/log_normal_summary.pdf
      hash: md5
      md5: a3aabb73cd33c92037e02f72b3a5fd20
      size: 27645
    - path: combined/weibull_aft.pdf
      hash: md5
      md5: 49724120c88ba73c618b8ee546a6fcfe
      size: 26881
    - path: combined/weibull_attack_eps_partial_effect.pdf
      hash: md5
      md5: b8ba602c754f3178278842c94cc38180
      size: 26258
    - path: combined/weibull_batch_size_partial_effect.pdf
      hash: md5
      md5: b83fd599a2769820183a57c437624d82
      size: 28543
    - path: combined/weibull_epochs_partial_effect.pdf
      hash: md5
      md5: f9efa1e57617d995e530fa6c0112d74b
      size: 27623
    - path: combined/weibull_qq.pdf
      hash: md5
      md5: 522a012736d5538c02bfb10e2d5f07b7
      size: 18121
    - path: combined/weibull_summary.csv
      hash: md5
      md5: 60e0589a5a15d42dff93363a7eb4321d
      size: 3496
    - path: combined/weibull_summary.pdf
      hash: md5
      md5: 05b2b0de63a2d292100236bf527da314
      size: 27676
  copy@mnist:
    cmd: rm -rf ~/kepler-ml/plots/mnist/ && mkdir -p ~/kepler-ml/plots/mnist/ && cp
      -r mnist/* ~/kepler-ml/plots/mnist/
    deps:
    - path: mnist/
      hash: md5
      md5: 89fafc7e0aaafc748f74caaac4dbe7e2.dir
      size: 25141861
      nfiles: 24
  copy@cifar:
    cmd: rm -rf ~/kepler-ml/plots/cifar/ && mkdir -p ~/kepler-ml/plots/cifar/ && cp
      -r cifar/* ~/kepler-ml/plots/cifar/
    deps:
    - path: cifar/
      hash: md5
      md5: 4474935bd04da73c4f70db6d808b2227.dir
      size: 25051159
      nfiles: 24
  copy@cifar100:
    cmd: rm -rf ~/kepler-ml/plots/cifar100/ && mkdir -p ~/kepler-ml/plots/cifar100/
      && cp -r cifar100/* ~/kepler-ml/plots/cifar100/
    deps:
    - path: cifar100/
      hash: md5
      md5: 3244237d5e5df4c3314b2340c519108a.dir
      size: 29857364
      nfiles: 24
  copy@combined:
    cmd: rm -rf ~/kepler-ml/plots/combined/ && mkdir -p ~/kepler-ml/plots/combined/
      && cp -r combined/* ~/kepler-ml/plots/combined/
    deps:
    - path: combined/
      hash: md5
      md5: c32bf818d3bafbf83cc12e8bb5629a8c.dir
      size: 38115902
      nfiles: 35
