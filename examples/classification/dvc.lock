schema: '2.0'
stages:
  print:
    cmd: cat params.yaml
  generate_data:
    cmd: python -m deckard.layers.runner generate_data --layer data
    params:
      params.yaml:
        data:
          files:
            data_filetype: pickle
            data_path: data
          generate:
            n_classes: 3
            n_features: 10
            n_informative: 8
            n_redundant: 1
            n_samples: 1000
            n_clusters_per_class: 1
          sklearn_pipeline:
            scaling:
              name: sklearn.preprocessing.StandardScaler
              with_mean: true
              with_std: true
          name:
          - classification
          sample:
            random_state: 42
            shuffle: true
            stratify: true
            time_series: true
        files:
          ground_truth_file: ground_truth.json
          predictions_file: predictions.json
          time_dict_file: time_dict.json
          params_file: params.json
          score_dict_file: scores.json
          path: reports
          attack_samples_file: adv_samples.json
          attack_predictions_file: adv_predictions.json
          attack_time_dict_file: adv_time_dict.json
          attack_params_file: attack_params.json
          attack_path: attack
    outs:
    - path: generate_data/data
      md5: 83f786b01a3cdf2c82bdf2d4863b80a7.dir
      size: 84369
      nfiles: 1
  train:
    cmd: python -m deckard.layers.runner
    deps:
    - path: generate_data/data
      md5: 83f786b01a3cdf2c82bdf2d4863b80a7.dir
      size: 84369
      nfiles: 1
    params:
      params.yaml:
        data:
          files:
            data_filetype: pickle
            data_path: data
          generate:
            n_classes: 3
            n_features: 10
            n_informative: 8
            n_redundant: 1
            n_samples: 1000
            n_clusters_per_class: 1
          sklearn_pipeline:
            scaling:
              name: sklearn.preprocessing.StandardScaler
              with_mean: true
              with_std: true
          name:
          - classification
          sample:
            random_state: 42
            shuffle: true
            stratify: true
            time_series: true
        files:
          ground_truth_file: ground_truth.json
          predictions_file: predictions.json
          time_dict_file: time_dict.json
          params_file: params.json
          score_dict_file: scores.json
          path: reports
          attack_samples_file: adv_samples.json
          attack_predictions_file: adv_predictions.json
          attack_time_dict_file: adv_time_dict.json
          attack_params_file: attack_params.json
          attack_path: attack
        model.files:
          model_filetype: pickle
          model_path: model
        model.init:
          loss: log
          name: sklearn.linear_model.SGDClassifier
        plots:
          balance: balance
          classification: classification
          confusion: confusion
          correlation: correlation
          radviz: radviz
          rank: rank
        scorers:
          accuracy:
            name: sklearn.metrics.accuracy_score
            normalize: true
          f1:
            average: weighted
            name: sklearn.metrics.f1_score
          precision:
            average: weighted
            name: sklearn.metrics.precision_score
          recall:
            average: weighted
            name: sklearn.metrics.recall_score
    outs:
    - path: reports/train
      md5: b925d1d8aec035d0dcfaaeec898ada0f.dir
      size: 108280
      nfiles: 10
    - path: train/data
      md5: b3f89bd412d1d92d109880d43dbbdae6.dir
      size: 92373
      nfiles: 1
    - path: train/model
      md5: 12dd771a85baffb15bc36f1d83665f53.dir
      size: 1209
      nfiles: 1
  sklearn_pipeline:
    cmd: python -m deckard.layers.train sklearn_pipeline
    deps:
    - path: train/data
      md5: e7ca9a385cb984848ac3786d1576a3b3.dir
      size: 8120393
      nfiles: 1
    - path: train/model
      md5: f8b2bbf0d9f6fdceb12e5e49ed3a0a0e.dir
      size: 6744
      nfiles: 2
    params:
      params.yaml:
        data:
          files:
            data_filetype: pickle
            data_path: data
          generate:
            n_classes: 3
            n_features: 100
            n_informative: 4
            n_redundant: 1
            n_samples: 10000
            n_clusters_per_class: 1
          name:
          - classification
          sample:
            random_state: 42
            shuffle: true
            stratify: true
            time_series: true
            train_size: 8000
        files:
          ground_truth_file: ground_truth.json
          params_file: params.json
          path: reports
          predictions_file: predictions.json
          score_dict_file: scores.json
          time_dict_file: time_dict.json
        model.files:
          model_filetype: pickle
          model_path: model
        model.init:
          loss: log
          name: sklearn.linear_model.SGDClassifier
        model.sklearn_pipeline:
          sklearn.feature_selection.SelectKBest:
            k: 50
        plots:
          balance: balance
          classification: classification
          confusion: confusion
          correlation: correlation
          radviz: radviz
          rank: rank
        scorers:
          accuracy:
            name: sklearn.metrics.accuracy_score
            normalize: true
          f1:
            average: weighted
            name: sklearn.metrics.f1_score
          precision:
            average: weighted
            name: sklearn.metrics.precision_score
          recall:
            average: weighted
            name: sklearn.metrics.recall_score
    outs:
    - path: reports/sklearn_pipeline
      md5: 3288cd03dca50a020031ccde9994a224.dir
      size: 190626
      nfiles: 10
    - path: sklearn_pipeline/data
      md5: 8946cf6b612fb109f0e0ed94d9cc9fac.dir
      size: 8120393
      nfiles: 1
    - path: sklearn_pipeline/model
      md5: b5e0f6c3a8c0cb8de807ef1922eca086.dir
      size: 6662
      nfiles: 2
  pipeline:
    cmd: python -m deckard.layers.runner pipeline
    deps:
    - path: train/data
      md5: b3f89bd412d1d92d109880d43dbbdae6.dir
      size: 92373
      nfiles: 1
    - path: train/model
      md5: 12dd771a85baffb15bc36f1d83665f53.dir
      size: 1209
      nfiles: 1
    params:
      params.yaml:
        data:
          files:
            data_filetype: pickle
            data_path: data
          generate:
            n_classes: 3
            n_features: 10
            n_informative: 8
            n_redundant: 1
            n_samples: 1000
            n_clusters_per_class: 1
          sklearn_pipeline:
            scaling:
              name: sklearn.preprocessing.StandardScaler
              with_mean: true
              with_std: true
          name:
          - classification
          sample:
            random_state: 42
            shuffle: true
            stratify: true
            time_series: true
        files:
          ground_truth_file: ground_truth.json
          predictions_file: predictions.json
          time_dict_file: time_dict.json
          params_file: params.json
          score_dict_file: scores.json
          path: reports
          attack_samples_file: adv_samples.json
          attack_predictions_file: adv_predictions.json
          attack_time_dict_file: adv_time_dict.json
          attack_params_file: attack_params.json
          attack_path: attack
        model.files:
          model_filetype: pickle
          model_path: model
        model.init:
          loss: log
          name: sklearn.linear_model.SGDClassifier
        plots:
          balance: balance
          classification: classification
          confusion: confusion
          correlation: correlation
          radviz: radviz
          rank: rank
        scorers:
          accuracy:
            name: sklearn.metrics.accuracy_score
            normalize: true
          f1:
            average: weighted
            name: sklearn.metrics.f1_score
          precision:
            average: weighted
            name: sklearn.metrics.precision_score
          recall:
            average: weighted
            name: sklearn.metrics.recall_score
    outs:
    - path: pipeline/data
      md5: 599b0019ab849cf169ba49bbe75c14c5.dir
      size: 92373
      nfiles: 1
    - path: pipeline/model
      md5: d9089de5e627703f6e1a16015354f799.dir
      size: 1209
      nfiles: 1
    - path: reports/pipeline
      md5: 6b5b56e84054a80e270566a1f6d8c121.dir
      size: 110502
      nfiles: 10
  defend:
    cmd: python -m deckard.layers.runner defend
    deps:
    - path: pipeline/data
      md5: 599b0019ab849cf169ba49bbe75c14c5.dir
      size: 92373
      nfiles: 1
    - path: pipeline/model
      md5: d9089de5e627703f6e1a16015354f799.dir
      size: 1209
      nfiles: 1
    params:
      params.yaml:
        data:
          files:
            data_filetype: pickle
            data_path: data
          generate:
            n_classes: 3
            n_features: 10
            n_informative: 8
            n_redundant: 1
            n_samples: 1000
            n_clusters_per_class: 1
          sklearn_pipeline:
            scaling:
              name: sklearn.preprocessing.StandardScaler
              with_mean: true
              with_std: true
          name:
          - classification
          sample:
            random_state: 42
            shuffle: true
            stratify: true
            time_series: true
        files:
          ground_truth_file: ground_truth.json
          predictions_file: predictions.json
          time_dict_file: time_dict.json
          params_file: params.json
          score_dict_file: scores.json
          path: reports
          attack_samples_file: adv_samples.json
          attack_predictions_file: adv_predictions.json
          attack_time_dict_file: adv_time_dict.json
          attack_params_file: attack_params.json
          attack_path: attack
        model.art_pipeline:
          preprocessor_defence:
            name: art.defences.preprocessor.FeatureSqueezing
            params:
              bit_depth: 8
              clip_values:
              - 0
              - 255
        model.files:
          model_filetype: pickle
          model_path: model
        model.init:
          loss: log
          name: sklearn.linear_model.SGDClassifier
        plots:
          balance: balance
          classification: classification
          confusion: confusion
          correlation: correlation
          radviz: radviz
          rank: rank
        scorers:
          accuracy:
            name: sklearn.metrics.accuracy_score
            normalize: true
          f1:
            average: weighted
            name: sklearn.metrics.f1_score
          precision:
            average: weighted
            name: sklearn.metrics.precision_score
          recall:
            average: weighted
            name: sklearn.metrics.recall_score
    outs:
    - path: defend/data
      md5: 17c3b2822e1f45e1d69cdbe55dd7bc94.dir
      size: 92373
      nfiles: 1
    - path: defend/model
      md5: 975a2d3d288b9c61c4591ff4355fb0e1.dir
      size: 1209
      nfiles: 1
    - path: reports/defend
      md5: 6356dd3d6a2735ec567f3539108723ed.dir
      size: 110971
      nfiles: 10
  attack:
    cmd: python -m deckard.layers.runner attack
    deps:
    - path: defend/data
      md5: 17c3b2822e1f45e1d69cdbe55dd7bc94.dir
      size: 92373
      nfiles: 1
    - path: defend/model
      md5: 975a2d3d288b9c61c4591ff4355fb0e1.dir
      size: 1209
      nfiles: 1
    params:
      params.yaml:
        attack:
          init:
            name: art.attacks.evasion.HopSkipJump
            max_iter: 1
            init_eval: 10
            init_size: 10
        data:
          files:
            data_filetype: pickle
            data_path: data
          generate:
            n_classes: 3
            n_features: 10
            n_informative: 8
            n_redundant: 1
            n_samples: 1000
            n_clusters_per_class: 1
          sklearn_pipeline:
            scaling:
              name: sklearn.preprocessing.StandardScaler
              with_mean: true
              with_std: true
          name:
          - classification
          sample:
            random_state: 42
            shuffle: true
            stratify: true
            time_series: true
        files:
          ground_truth_file: ground_truth.json
          predictions_file: predictions.json
          time_dict_file: time_dict.json
          params_file: params.json
          score_dict_file: scores.json
          path: reports
          attack_samples_file: adv_samples.json
          attack_predictions_file: adv_predictions.json
          attack_time_dict_file: adv_time_dict.json
          attack_params_file: attack_params.json
          attack_path: attack
        model:
          files:
            model_filetype: pickle
            model_path: model
          init:
            loss: log
            name: sklearn.linear_model.SGDClassifier
          sklearn_pipeline:
            feature_selection:
              name: sklearn.feature_selection.SelectKBest
              k: 3
          art_pipeline:
            preprocessor_defence:
              name: art.defences.preprocessor.FeatureSqueezing
              params:
                bit_depth: 8
                clip_values:
                - 0
                - 255
        plots:
          balance: balance
          classification: classification
          confusion: confusion
          correlation: correlation
          radviz: radviz
          rank: rank
        scorers:
          accuracy:
            name: sklearn.metrics.accuracy_score
            normalize: true
          f1:
            average: weighted
            name: sklearn.metrics.f1_score
          precision:
            average: weighted
            name: sklearn.metrics.precision_score
          recall:
            average: weighted
            name: sklearn.metrics.recall_score
    outs:
    - path: reports/attack
      md5: eedc569d0af6b6664f8ac9bb0f175827.dir
      size: 263731
      nfiles: 18
  evaluate:
    cmd: python -m deckard.layers.runner evaluate --layer evaluate
    deps:
    - path: reports/attack
      md5: eedc569d0af6b6664f8ac9bb0f175827.dir
      size: 263731
      nfiles: 18
    - path: reports/defend
      md5: 6356dd3d6a2735ec567f3539108723ed.dir
      size: 110971
      nfiles: 10
    params:
      params.yaml:
        attack:
          init:
            name: art.attacks.evasion.HopSkipJump
            max_iter: 1
            init_eval: 10
            init_size: 10
        data:
          files:
            data_filetype: pickle
            data_path: data
          generate:
            n_classes: 3
            n_features: 10
            n_informative: 8
            n_redundant: 1
            n_samples: 1000
            n_clusters_per_class: 1
          sklearn_pipeline:
            scaling:
              name: sklearn.preprocessing.StandardScaler
              with_mean: true
              with_std: true
          name:
          - classification
          sample:
            random_state: 42
            shuffle: true
            stratify: true
            time_series: true
        files:
          ground_truth_file: ground_truth.json
          predictions_file: predictions.json
          time_dict_file: time_dict.json
          params_file: params.json
          score_dict_file: scores.json
          path: reports
          attack_samples_file: adv_samples.json
          attack_predictions_file: adv_predictions.json
          attack_time_dict_file: adv_time_dict.json
          attack_params_file: attack_params.json
          attack_path: attack
        model:
          files:
            model_filetype: pickle
            model_path: model
          init:
            loss: log
            name: sklearn.linear_model.SGDClassifier
          sklearn_pipeline:
            feature_selection:
              name: sklearn.feature_selection.SelectKBest
              k: 3
          art_pipeline:
            preprocessor_defence:
              name: art.defences.preprocessor.FeatureSqueezing
              params:
                bit_depth: 8
                clip_values:
                - 0
                - 255
        plots:
          balance: balance
          classification: classification
          confusion: confusion
          correlation: correlation
          radviz: radviz
          rank: rank
        scorers:
          accuracy:
            name: sklearn.metrics.accuracy_score
            normalize: true
          f1:
            average: weighted
            name: sklearn.metrics.f1_score
          precision:
            average: weighted
            name: sklearn.metrics.precision_score
          recall:
            average: weighted
            name: sklearn.metrics.recall_score
    outs:
    - path: reports/evaluate
      md5: f41273e332596db5c07c422185d150d2.dir
      size: 5731
      nfiles: 5
  visualise:
    cmd: python -m deckard.layers.runner visualise --layer visualise
    deps:
    - path: reports/attack
      md5: eedc569d0af6b6664f8ac9bb0f175827.dir
      size: 263731
      nfiles: 18
    - path: reports/defend
      md5: 6356dd3d6a2735ec567f3539108723ed.dir
      size: 110971
      nfiles: 10
    params:
      params.yaml:
        attack:
          init:
            name: art.attacks.evasion.HopSkipJump
            max_iter: 1
            init_eval: 10
            init_size: 10
        data:
          files:
            data_filetype: pickle
            data_path: data
          generate:
            n_classes: 3
            n_features: 10
            n_informative: 8
            n_redundant: 1
            n_samples: 1000
            n_clusters_per_class: 1
          sklearn_pipeline:
            scaling:
              name: sklearn.preprocessing.StandardScaler
              with_mean: true
              with_std: true
          name:
          - classification
          sample:
            random_state: 42
            shuffle: true
            stratify: true
            time_series: true
        files:
          ground_truth_file: ground_truth.json
          predictions_file: predictions.json
          time_dict_file: time_dict.json
          params_file: params.json
          score_dict_file: scores.json
          path: reports
          attack_samples_file: adv_samples.json
          attack_predictions_file: adv_predictions.json
          attack_time_dict_file: adv_time_dict.json
          attack_params_file: attack_params.json
          attack_path: attack
        model:
          files:
            model_filetype: pickle
            model_path: model
          init:
            loss: log
            name: sklearn.linear_model.SGDClassifier
          sklearn_pipeline:
            feature_selection:
              name: sklearn.feature_selection.SelectKBest
              k: 3
          art_pipeline:
            preprocessor_defence:
              name: art.defences.preprocessor.FeatureSqueezing
              params:
                bit_depth: 8
                clip_values:
                - 0
                - 255
        plots:
          balance: balance
          classification: classification
          confusion: confusion
          correlation: correlation
          radviz: radviz
          rank: rank
        scorers:
          accuracy:
            name: sklearn.metrics.accuracy_score
            normalize: true
          f1:
            average: weighted
            name: sklearn.metrics.f1_score
          precision:
            average: weighted
            name: sklearn.metrics.precision_score
          recall:
            average: weighted
            name: sklearn.metrics.recall_score
    outs:
    - path: reports/visualise
      md5: fb928e2fdf4c869f367a0b94e5d63ca4.dir
      size: 110087
      nfiles: 9
